<!DOCTYPE html>
<html lang=zh>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  <!-- Color theme for statusbar -->
  <meta name="theme-color" content="#000000" />
  <!-- å¼ºåˆ¶é¡µé¢åœ¨å½“å‰çª—å£ä»¥ç‹¬ç«‹é¡µé¢æ˜¾ç¤º,é˜²æ­¢åˆ«äººåœ¨æ¡†æ¶é‡Œè°ƒç”¨é¡µé¢ -->
  <meta http-equiv="window-target" content="_top" />
  
  
  <title>ç”¨æˆ·ç®¡ç†ç³»ç»Ÿ | WINGO BLOG</title>
  <meta name="description" content="åŸºäº Spring Boot çš„ç”¨æˆ·ç®¡ç†ç³»ç»Ÿã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="ç”¨æˆ·ç®¡ç†ç³»ç»Ÿ">
<meta property="og:url" content="https://wingowen.github.io/2020/03/07/%E5%90%8E%E5%8F%B0%E6%8A%80%E6%9C%AF/%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91/%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/index.html">
<meta property="og:site_name" content="WINGO&#39;S BLOG">
<meta property="og:description" content="åŸºäº Spring Boot çš„ç”¨æˆ·ç®¡ç†ç³»ç»Ÿã€‚">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://wingowen.github.io/img/2020/03/UserManagementSystem/Demand.PNG">
<meta property="og:image" content="https://wingowen.github.io/img/2020/03/UserManagementSystem/Database01.PNG">
<meta property="og:image" content="https://wingowen.github.io/img/2020/03/UserManagementSystem/Port.png">
<meta property="og:image" content="https://wingowen.github.io/img/2020/03/UserManagementSystem/VO.PNG">
<meta property="og:image" content="https://wingowen.github.io/img/2020/03/UserManagementSystem/ValidError01.png">
<meta property="og:image" content="https://wingowen.github.io/img/2020/03/UserManagementSystem/ValidError02.png">
<meta property="og:image" content="https://wingowen.github.io/img/2020/03/UserManagementSystem/ValidError03.png">
<meta property="og:image" content="https://wingowen.github.io/img/2020/03/UserManagementSystem/SQLLog01.png">
<meta property="og:image" content="https://wingowen.github.io/img/2020/03/UserManagementSystem/SQLLog03.png">
<meta property="article:published_time" content="2020-03-07T08:44:21.000Z">
<meta property="article:modified_time" content="2023-09-20T08:20:35.793Z">
<meta property="article:author" content="Wingo Wen">
<meta property="article:tag" content="demo">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://wingowen.github.io/img/2020/03/UserManagementSystem/Demand.PNG">
  <!-- Canonical links -->
  <link rel="canonical" href="https://wingowen.github.io/2020/03/07/%E5%90%8E%E5%8F%B0%E6%8A%80%E6%9C%AF/%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91/%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/index.html">
  
  
    <link rel="icon" href="/favicon.png" type="image/x-icon">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  
  
  
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.1.0"><link rel="alternate" href="/atom.xml" title="WINGO'S BLOG" type="application/atom+xml">
</head>


<body class="main-center" itemscope itemtype="http://schema.org/WebPage">
  <header class="header" itemscope itemtype="http://schema.org/WPHeader">
  <div class="slimContent">
    <div class="navbar-header">
      
      
      <div class="profile-block text-center">
        <a id="avatar" href="" target="_blank">
          <img class="img-circle img-rotate" src="/images/avatar.jpg" width="200" height="200">
        </a>
        <h2 id="name" class="hidden-xs hidden-sm">WINGO.WEN</h2>
        <h3 id="title" class="hidden-xs hidden-sm hidden-md"></h3>
        <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> Shenzhen, China</small>
      </div>
      
      <div class="search" id="search-form-wrap">

    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="æœç´¢" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i class="icon icon-search"></i></button>
            </span>
        </div>
    </form>
    <div class="ins-search">
  <div class="ins-search-mask"></div>
  <div class="ins-search-container">
    <div class="ins-input-wrapper">
      <input type="text" class="ins-search-input" placeholder="æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ..." x-webkit-speech />
      <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">Ã—</span></button>
    </div>
    <div class="ins-section-wrapper">
      <div class="ins-section-container"></div>
    </div>
  </div>
</div>


</div>
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
      <ul class="nav navbar-nav main-nav menu-highlight">
        
        
        <li class="menu-item menu-item-home">
          <a href="/.">
            
            <i class="icon icon-home-fill"></i>
            
            <span class="menu-title">é¦–é¡µ</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-tags">
          <a href="/tags">
            
            <i class="icon icon-tags"></i>
            
            <span class="menu-title">æ ‡ç­¾</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-categories">
          <a href="/categories">
            
            <i class="icon icon-folder"></i>
            
            <span class="menu-title">åˆ†ç±»</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            
            <i class="icon icon-archives-fill"></i>
            
            <span class="menu-title">å½’æ¡£</span>
          </a>
        </li>
        
      </ul>
      
    </nav>
  </div>
</header>

  
    <aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">å…¬å‘Š</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content">
                <p>å¾—å¤±ä»ç¼˜ å¿ƒæ— å¢å‡</p>
            </div>
        </div>
    </div>
</div>

    
      
  <div class="widget">
    <h3 class="widget-title">åˆ†ç±»</h3>
    <div class="widget-body">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a><span class="category-list-count">26</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%9F%BA%E7%A1%80%E7%A7%91%E5%AD%A6/">åŸºç¡€ç§‘å­¦</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/">å¤§æ•°æ®</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">æ•°æ®åº“</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">æœºå™¨å­¦ä¹ </a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9D%82%E9%A1%B9/">æ‚é¡¹</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/">è®¡ç®—æœºç§‘å­¦</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%BF%90%E7%BB%B4/">è¿ç»´</a><span class="category-list-count">5</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">æ ‡ç­¾äº‘</h3>
    <div class="widget-body tagcloud">
      <a href="/tags/Aysnc/" style="font-size: 13px;">Aysnc</a> <a href="/tags/Cache/" style="font-size: 13px;">Cache</a> <a href="/tags/Druid/" style="font-size: 13px;">Druid</a> <a href="/tags/Dubbo/" style="font-size: 13px;">Dubbo</a> <a href="/tags/ElasticSearch/" style="font-size: 13px;">ElasticSearch</a> <a href="/tags/Email/" style="font-size: 13px;">Email</a> <a href="/tags/Flume/" style="font-size: 13px;">Flume</a> <a href="/tags/Git/" style="font-size: 13px;">Git</a> <a href="/tags/HBase/" style="font-size: 13px;">HBase</a> <a href="/tags/Hadoop/" style="font-size: 13px;">Hadoop</a> <a href="/tags/Hive/" style="font-size: 13.2px;">Hive</a> <a href="/tags/Impala/" style="font-size: 13px;">Impala</a> <a href="/tags/InooDB/" style="font-size: 13px;">InooDB</a> <a href="/tags/JDBC/" style="font-size: 13px;">JDBC</a> <a href="/tags/JPA/" style="font-size: 13px;">JPA</a> <a href="/tags/Kafka/" style="font-size: 13px;">Kafka</a> <a href="/tags/Kudu/" style="font-size: 13.2px;">Kudu</a> <a href="/tags/Linux/" style="font-size: 13px;">Linux</a> <a href="/tags/Log/" style="font-size: 13px;">Log</a> <a href="/tags/MQ/" style="font-size: 13.2px;">MQ</a> <a href="/tags/MyBatis/" style="font-size: 13px;">MyBatis</a> <a href="/tags/MySQL/" style="font-size: 13px;">MySQL</a> <a href="/tags/Netty/" style="font-size: 14px;">Netty</a> <a href="/tags/Pandas/" style="font-size: 13px;">Pandas</a> <a href="/tags/SQL/" style="font-size: 13px;">SQL</a> <a href="/tags/Scheduled/" style="font-size: 13px;">Scheduled</a> <a href="/tags/Security/" style="font-size: 13px;">Security</a> <a href="/tags/Shiro/" style="font-size: 13px;">Shiro</a> <a href="/tags/Spring-Boot/" style="font-size: 14px;">Spring Boot</a> <a href="/tags/Web/" style="font-size: 13px;">Web</a> <a href="/tags/WebSocket/" style="font-size: 13px;">WebSocket</a> <a href="/tags/demo/" style="font-size: 13.4px;">demo</a> <a href="/tags/gRPC/" style="font-size: 13px;">gRPC</a> <a href="/tags/peewee/" style="font-size: 13px;">peewee</a> <a href="/tags/sklearn/" style="font-size: 13px;">sklearn</a> <a href="/tags/%E5%B7%A5%E4%BD%9C/" style="font-size: 13px;">å·¥ä½œ</a> <a href="/tags/%E7%88%AC%E8%99%AB/" style="font-size: 13px;">çˆ¬è™«</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 13.6px;">ç®—æ³•</a> <a href="/tags/%E7%BD%91%E7%BB%9C/" style="font-size: 13px;">ç½‘ç»œ</a> <a href="/tags/%E8%80%83%E7%A0%94/" style="font-size: 13.8px;">è€ƒç ”</a> <a href="/tags/%E8%84%9A%E6%9C%AC%E5%91%BD%E4%BB%A4/" style="font-size: 13px;">è„šæœ¬å‘½ä»¤</a> <a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" style="font-size: 13px;">è®¾è®¡æ¨¡å¼</a> <a href="/tags/%E9%83%A8%E7%BD%B2/" style="font-size: 13px;">éƒ¨ç½²</a>
    </div>
  </div>

    
      
  <div class="widget">
    <h3 class="widget-title">å½’æ¡£</h3>
    <div class="widget-body">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/05/">äº”æœˆ 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/04/">å››æœˆ 2024</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/09/">ä¹æœˆ 2023</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">ä¸€æœˆ 2023</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">ä¹æœˆ 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">å…«æœˆ 2022</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">ä¸ƒæœˆ 2022</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">å››æœˆ 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">ä¹æœˆ 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">å…«æœˆ 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">äº”æœˆ 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">å››æœˆ 2020</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">ä¸‰æœˆ 2020</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">äºŒæœˆ 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">ä¸€æœˆ 2020</a><span class="archive-list-count">9</span></li></ul>
    </div>
  </div>


    
  </div>
</aside>

  
  
  <aside class="sidebar sidebar-toc collapse   in  " id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    <nav id="toc" class="article-toc">
      <h3 class="toc-title">æ–‡ç« ç›®å½•</h3>
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C"><span class="toc-number">1.</span> <span class="toc-text"> å‡†å¤‡å·¥ä½œ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A5%E5%8F%A3%E7%9A%84%E8%AE%BE%E8%AE%A1"><span class="toc-number">2.</span> <span class="toc-text"> æ¥å£çš„è®¾è®¡</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#dto-%E7%B1%BB%E7%9A%84%E7%BC%96%E5%86%99"><span class="toc-number">2.1.</span> <span class="toc-text"> DTO ç±»çš„ç¼–å†™</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#vo-%E7%B1%BB%E7%9A%84%E7%BC%96%E5%86%99"><span class="toc-number">2.2.</span> <span class="toc-text"> VO ç±»çš„ç¼–å†™</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E5%B8%B8%E9%87%8F%E7%B1%BB"><span class="toc-number">3.</span> <span class="toc-text"> é™æ€å¸¸é‡ç±»</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#urlconstant"><span class="toc-number">3.1.</span> <span class="toc-text"> UrlConstant</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#usertypeconstant"><span class="toc-number">3.2.</span> <span class="toc-text"> UserTypeConstant</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#imagecodeconstant"><span class="toc-number">3.3.</span> <span class="toc-text"> ImageCodeConstant</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#respoonseconstant"><span class="toc-number">3.4.</span> <span class="toc-text"> RespoonseConstant</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#userconstant"><span class="toc-number">3.5.</span> <span class="toc-text"> UserConstant</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%A5%E5%85%B7%E7%B1%BB"><span class="toc-number">4.</span> <span class="toc-text"> å·¥å…·ç±»</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#md5-%E5%AF%86%E7%A0%81%E5%8A%A0%E5%AF%86"><span class="toc-number">4.1.</span> <span class="toc-text"> MD5 å¯†ç åŠ å¯†</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%AA%8C%E8%AF%81%E7%A0%81%E7%94%9F%E6%88%90"><span class="toc-number">4.2.</span> <span class="toc-text"> éªŒè¯ç ç”Ÿæˆ</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E4%BD%93%E7%B1%BB"><span class="toc-number">5.</span> <span class="toc-text"> å®ä½“ç±»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%BA%90"><span class="toc-number">6.</span> <span class="toc-text"> æ•°æ®æº</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#druid-%E8%BF%9E%E6%8E%A5%E6%B1%A0"><span class="toc-number">6.1.</span> <span class="toc-text"> Druid è¿æ¥æ± </span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#druid-%E9%85%8D%E7%BD%AE"><span class="toc-number">6.2.</span> <span class="toc-text"> Druid é…ç½®</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B4%E5%90%88-mybatis"><span class="toc-number">7.</span> <span class="toc-text"> æ•´åˆ Mybatis</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE-mapper"><span class="toc-number">7.1.</span> <span class="toc-text"> é…ç½® Mapper</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#mapper-%E6%8E%A5%E5%8F%A3%E7%B1%BB"><span class="toc-number">7.2.</span> <span class="toc-text"> Mapper æ¥å£ç±»</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#mapper-%E9%85%8D%E7%BD%AE%E5%AE%9E%E7%8E%B0"><span class="toc-number">7.3.</span> <span class="toc-text"> Mapper é…ç½®å®ç°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%96%E5%86%99%E6%B5%8B%E8%AF%95%E6%96%B9%E6%B3%95"><span class="toc-number">7.4.</span> <span class="toc-text"> ç¼–å†™æµ‹è¯•æ–¹æ³•</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91%E5%B1%82"><span class="toc-number">8.</span> <span class="toc-text"> ä¸šåŠ¡é€»è¾‘å±‚</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#mybatis-%E7%89%88%E6%9C%AC"><span class="toc-number">8.1.</span> <span class="toc-text"> Mybatis ç‰ˆæœ¬</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B"><span class="toc-number">8.2.</span> <span class="toc-text"> æµ‹è¯•ç”¨ä¾‹</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A7%E5%88%B6%E5%B1%82"><span class="toc-number">9.</span> <span class="toc-text"> æ§åˆ¶å±‚</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#swagger-%E6%95%B4%E5%90%88"><span class="toc-number">9.1.</span> <span class="toc-text"> Swagger æ•´åˆ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E7%BC%96%E5%86%99"><span class="toc-number">9.2.</span> <span class="toc-text"> ä»£ç ç¼–å†™</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#thymeleaf"><span class="toc-number">10.</span> <span class="toc-text"> Thymeleaf</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#loginhtml"><span class="toc-number">10.1.</span> <span class="toc-text"> login.html</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#indexhtml"><span class="toc-number">10.2.</span> <span class="toc-text"> index.html</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#modifyhtml"><span class="toc-number">10.3.</span> <span class="toc-text"> modify.html</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#registerhtml"><span class="toc-number">10.4.</span> <span class="toc-text"> register.html</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#userhtml"><span class="toc-number">10.5.</span> <span class="toc-text"> user.html</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#viewhtml"><span class="toc-number">10.6.</span> <span class="toc-text"> view.html</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4%E5%99%A8"><span class="toc-number">11.</span> <span class="toc-text"> è¿‡æ»¤å™¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%A8%E5%B1%80%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86"><span class="toc-number">12.</span> <span class="toc-text"> å…¨å±€å¼‚å¸¸å¤„ç†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89-sql-%E6%97%A5%E5%BF%97%E6%89%93%E5%8D%B0"><span class="toc-number">13.</span> <span class="toc-text"> è‡ªå®šä¹‰ SQL æ—¥å¿—æ‰“å°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%A8%E5%9F%9F"><span class="toc-number">14.</span> <span class="toc-text"> è·¨åŸŸ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F"><span class="toc-number">14.1.</span> <span class="toc-text"> æ³¨æ„</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%A0%A1%E9%AA%8C"><span class="toc-number">15.</span> <span class="toc-text"> è‡ªå®šä¹‰æ ¡éªŒ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%A8%E8%A7%A3%E7%B1%BB"><span class="toc-number">15.1.</span> <span class="toc-text"> æ³¨è§£ç±»</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%A1%E9%AA%8C%E7%B1%BB"><span class="toc-number">15.2.</span> <span class="toc-text"> æ ¡éªŒç±»</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E5%93%8D%E5%BA%94%E6%89%93%E5%8D%B0"><span class="toc-number">16.</span> <span class="toc-text"> è¯·æ±‚å“åº”æ‰“å°</span></a></li></ol>
    </nav>
  </div>
</aside>

<main class="main" role="main">
  <div class="content">
  <article id="post-åå°æŠ€æœ¯/é¡¹ç›®å¼€å‘/ç”¨æˆ·ç®¡ç†ç³»ç»Ÿ" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      
        
  
    <h1 class="article-title" itemprop="name">
      ç”¨æˆ·ç®¡ç†ç³»ç»Ÿ
    </h1>
  

      
      <div class="article-meta">
        <span class="article-date">
    <i class="icon icon-calendar-check"></i>
	<a href="/2020/03/07/%E5%90%8E%E5%8F%B0%E6%8A%80%E6%9C%AF/%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91/%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/" class="article-date">
	  <time datetime="2020-03-07T08:44:21.000Z" itemprop="datePublished">2020-03-07</time>
	</a>
</span>
        
  <span class="article-category">
    <i class="icon icon-folder"></i>
    <a class="article-category-link" href="/categories/Java/">Java</a>
  </span>

        
  <span class="article-tag">
    <i class="icon icon-tags"></i>
	<a class="article-tag-link-link" href="/tags/demo/" rel="tag">demo</a>
  </span>


        

        <!-- <span class="post-comment"><i class="icon icon-comment"></i> <a href="/2020/03/07/%E5%90%8E%E5%8F%B0%E6%8A%80%E6%9C%AF/%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91/%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/#comments" class="article-comment-link">è¯„è®º</a></span> -->
        
      </div>
    </div>
    <div class="article-entry marked-body" itemprop="articleBody">
      
        <p>åŸºäº Spring Boot çš„ç”¨æˆ·ç®¡ç†ç³»ç»Ÿã€‚</p>
<span id="more"></span>
<h3 id="å‡†å¤‡å·¥ä½œ"><a class="markdownIt-Anchor" href="#å‡†å¤‡å·¥ä½œ"></a> å‡†å¤‡å·¥ä½œ</h3>
<p>åŠŸèƒ½æ¨¡å—åˆ†æï¼š</p>
<p><img src="/img/2020/03/UserManagementSystem/Demand.PNG" alt="" /></p>
<p>æ•°æ®åº“è¡¨åˆ†æï¼š</p>
<p><img src="/img/2020/03/UserManagementSystem/Database01.PNG" alt="" /></p>
<p>æ•°æ®åº“å»ºè¡¨è¯­å¥ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `user_manage_demo` (</span><br><span class="line">  `user_id` <span class="type">bigint</span>(<span class="number">11</span>) unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;ä¸»é”®idï¼Œç”¨æˆ·id&#x27;</span>,</span><br><span class="line">  `username` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ç”¨æˆ·å&#x27;</span>,</span><br><span class="line">  `password` <span class="type">varchar</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ç”¨æˆ·å¯†ç &#x27;</span>,</span><br><span class="line">  `type` <span class="type">char</span>(<span class="number">1</span>) unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ç”¨æˆ·ç±»å‹ï¼ˆ1ï¼šç®¡ç†å‘˜ï¼›0ï¼šæ™®é€šç”¨æˆ·ï¼‰&#x27;</span>,</span><br><span class="line">  `gmt_create` datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;è®°å½•åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">  `gmt_modified` datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;è®°å½•ä¿®æ”¹æ—¶é—´&#x27;</span>,</span><br><span class="line">  `is_delete` tinyint(<span class="number">1</span>) unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;è®°å½•æ˜¯å¦é€»è¾‘åˆ é™¤ï¼ˆ0ï¼šæœªåˆ é™¤ï¼›1ï¼šå·²åˆ é™¤ï¼‰&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`user_id`),</span><br><span class="line">  <span class="keyword">UNIQUE</span> KEY `uk_name_type` (`username`,`type`) <span class="keyword">USING</span> BTREE COMMENT <span class="string">&#x27;ç”¨æˆ·åç§°ã€ç±»å‹å”¯ä¸€ç´¢å¼•&#x27;</span></span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">6</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 COMMENT<span class="operator">=</span><span class="string">&#x27;ç”¨æˆ·ç®¡ç†è¡¨&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>åœ¨æ•°æ®åº“è¡¨ä¸­åˆå§‹åŒ–ä¸€æ¡ç®¡ç†å‘˜æ•°æ®ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `springboot_user`.`<span class="keyword">user</span>`</span><br><span class="line">	(`user_id`, `username`, `password`, `type`, `gmt_create`, `gmt_modified`, `is_delete`) </span><br><span class="line"><span class="keyword">VALUES</span> </span><br><span class="line">	(<span class="number">1</span>, <span class="string">&#x27;admin&#x27;</span>, <span class="string">&#x27;123456&#x27;</span>, &quot;1&quot;, <span class="string">&#x27;2019-05-19 20:26:22&#x27;</span>, <span class="string">&#x27;2019-05-19 20:26:27&#x27;</span>, <span class="number">0</span>);</span><br></pre></td></tr></table></figure>
<h3 id="æ¥å£çš„è®¾è®¡"><a class="markdownIt-Anchor" href="#æ¥å£çš„è®¾è®¡"></a> æ¥å£çš„è®¾è®¡</h3>
<blockquote>
<p>ä¸ºäº†é¡¹ç›®ä»£ç æ›´åŠ ç®€æ´ï¼Œæ­¤é¡¹ç›®æ·»åŠ äº† Lombok æ”¯æŒä¾èµ–å¹¶ä¸” IDEA æ·»åŠ äº†ç›¸åº”çš„ Lombok æ’ä»¶ï¼Œé€šè¿‡åœ¨ç±»æ³¨é‡Š<code>@Data</code>ä¸ºç›¸åº”çš„ç±»æ·»åŠ Getter/Setterï¼ŒtoString()ï¼Œequals() ç­‰æ–¹æ³•ã€‚</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- æ·»åŠ  Lombok çš„æ”¯æŒ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</blockquote>
<p><img src="/img/2020/03/UserManagementSystem/Port.png" alt="" /></p>
<p>å°†å‰ç«¯ä¼ è¾“è¿‡æ¥çš„çš„æ•°æ®å°è£…åœ¨å¯¹åº”çš„ DTO ç±»ä¸­ï¼Œç”¨äºå±•ç¤ºå±‚ä¸æœåŠ¡å±‚ä¹‹é—´çš„æ•°æ®ä¼ è¾“å¯¹è±¡ã€‚ï¼ˆView ğŸ‘‰ Action ğŸ‘‰ Srviceï¼‰</p>
<blockquote>
<p>DTOï¼šData Transfer Objectï¼ˆæ•°æ®ä¼ è¾“å¯¹è±¡ï¼‰DTO æ˜¯ä¸€ç»„éœ€è¦è·¨è¿›ç¨‹æˆ–ç½‘ç»œè¾¹ç•Œä¼ è¾“çš„èšåˆæ•°æ®çš„ç®€å•å®¹å™¨ã€‚å®ƒä¸åº”è¯¥åŒ…å«ä¸šåŠ¡é€»è¾‘ï¼Œå¹¶å°†å…¶è¡Œä¸ºé™åˆ¶ä¸ºè¯¸å¦‚å†…éƒ¨ä¸€è‡´æ€§æ£€æŸ¥å’ŒåŸºæœ¬éªŒè¯ä¹‹ç±»çš„æ´»åŠ¨ã€‚</p>
</blockquote>
<p>å°†è¿”å›å‰ç«¯çš„æ•°æ®å°è£…åœ¨å¯¹åº”çš„ VO ç±»ä¸­ã€‚</p>
<blockquote>
<p>VOï¼šView Objectï¼ˆè§†å›¾å¯¹è±¡ï¼‰VO çš„ä½œç”¨æ˜¯æŠŠæŸä¸ªæŒ‡å®šé¡µé¢ï¼ˆæˆ–ç»„ä»¶ï¼‰çš„æ‰€æœ‰æ•°æ®å°è£…èµ·æ¥ã€‚</p>
</blockquote>
<h4 id="dto-ç±»çš„ç¼–å†™"><a class="markdownIt-Anchor" href="#dto-ç±»çš„ç¼–å†™"></a> DTO ç±»çš„ç¼–å†™</h4>
<p>åœ¨ DTO ç±»ä¸­æ·»åŠ  JSR303 æ ¡éªŒã€‚</p>
<blockquote>
<p>JSR303 æ˜¯ä¸€é¡¹æ ‡å‡†ï¼ŒJSR-349 æ˜¯å…¶çš„å‡çº§ç‰ˆæœ¬ï¼Œæ·»åŠ äº†ä¸€äº›æ–°ç‰¹æ€§ï¼Œä»–ä»¬è§„å®šä¸€äº›æ ¡éªŒè§„èŒƒå³æ ¡éªŒæ³¨è§£ï¼Œå¦‚ <code>@Null</code>ï¼Œ<code>@NotNull</code>ï¼Œ<code>@Pattern</code>ï¼Œåœ¨ javax.validation.constraints åŒ…ä¸‹ï¼Œåªæä¾›è§„èŒƒä¸æä¾›å®ç°ã€‚</p>
<p>Hibernat Validation æ˜¯å¯¹è¿™ä¸ªè§„èŒƒçš„å®è·µï¼ˆä¸è¦å°† Hibernate å’Œæ•°æ®åº“ ORM æ¡†æ¶è”ç³»åœ¨ä¸€èµ·ï¼‰ï¼Œä»–æä¾›äº†ç›¸åº”çš„å®ç°ï¼Œå¹¶å¢åŠ äº†ä¸€äº›å…¶ä»–æ ¡éªŒæ³¨è§£ï¼Œå¦‚<code>@Email</code>ï¼Œ<code>@Length</code>ï¼Œ<code>@Range</code>ç­‰ç­‰ï¼Œåœ¨ org.hibernate.validator.constraints åŒ…ä¸‹ã€‚</p>
<p>Spring ä¸ºäº†ç»™å¼€å‘è€…æä¾›ä¾¿æ·ï¼Œå¯¹ Hibernate Validation è¿›è¡Œäº†äºŒæ¬¡å°è£…ï¼Œæ˜¾ç¤ºæ ¡éªŒ Validated Bean æ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨ Spring validation æˆ–è€… Hibernate validationï¼Œè€Œ Spring Validation å¦ä¸€ä¸ªç‰¹æ€§ï¼Œä¾¿æ˜¯å…¶åœ¨ Spring MVC æ¨¡å—ä¸­æ·»åŠ äº†è‡ªåŠ¨æ ¡éªŒï¼Œå¹¶å°†æ ¡éªŒä¿¡æ¯å°è£…è¿›äº†ç‰¹å®šçš„ç±»ä¸­ã€‚è¿™æ— ç–‘ä¾¿æ·äº†æˆ‘ä»¬çš„ web å¼€å‘ã€‚</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* DTO ç±»ç¤ºä¾‹</span></span><br><span class="line"><span class="comment">* <span class="doctag">@NotBlank</span> ç”¨äº Stringï¼ˆä¼šå»æ‰ç©ºæ ¼ï¼‰</span></span><br><span class="line"><span class="comment">* <span class="doctag">@NotNull</span> ç”¨äº Integer</span></span><br><span class="line"><span class="comment">* <span class="doctag">@Data</span> è‡ªåŠ¨ç”Ÿæˆ Getter/Setterï¼ŒtoString()ï¼Œequals() ç­‰æ–¹æ³•</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginDTO</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** ç”¨æˆ·å */</span></span><br><span class="line">    <span class="meta">@NotBlank(message = &quot;ç”¨æˆ·åä¸èƒ½ä¸ºç©º&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="comment">/** ç”¨æˆ·å¯†ç  */</span></span><br><span class="line">    <span class="meta">@NotBlank(message = &quot;ç”¨æˆ·å¯†ç ä¸èƒ½ä¸ºç©º&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    <span class="comment">/** éªŒè¯ç  */</span></span><br><span class="line">    <span class="meta">@NotBlank(message = &quot;éªŒè¯ç ä¸èƒ½ä¸ºç©º&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String checkCode;</span><br><span class="line">    <span class="comment">/** ç±»å‹ */</span></span><br><span class="line">    <span class="meta">@NotNull(message = &quot;ç”¨æˆ·ç±»å‹ä¸èƒ½ä¸ºç©º&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String type;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="vo-ç±»çš„ç¼–å†™"><a class="markdownIt-Anchor" href="#vo-ç±»çš„ç¼–å†™"></a> VO ç±»çš„ç¼–å†™</h4>
<p><img src="/img/2020/03/UserManagementSystem/VO.PNG" alt="" /></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* VO ç±»ç¤ºä¾‹</span></span><br><span class="line"><span class="comment">* ç®¡ç†å‘˜ç”¨æˆ·åˆ—è¡¨é¡µé¢çš„ç”¨æˆ·ä¿¡æ¯è¿”å›å¯¹è±¡</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ViewVO</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** ç”¨æˆ·æ ‡è¯† */</span></span><br><span class="line">    <span class="keyword">private</span> Integer userId;</span><br><span class="line">    <span class="comment">/** ç”¨æˆ·å */</span></span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="comment">/** ç”¨æˆ·ç±»å‹ */</span></span><br><span class="line">    <span class="keyword">private</span> String type;</span><br><span class="line">    <span class="comment">/** ç”¨æˆ·åˆ›å»ºæ—¶é—´ */</span></span><br><span class="line">    <span class="keyword">private</span> Date gtmCreate;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="é™æ€å¸¸é‡ç±»"><a class="markdownIt-Anchor" href="#é™æ€å¸¸é‡ç±»"></a> é™æ€å¸¸é‡ç±»</h3>
<p>å°†é¡¹ç›®ä¸­ä¸€äº›å›ºå®šçš„å­—é¢é‡å®šä¹‰ä¸ºä¸å¯å˜çš„é™æ€å¸¸é‡<code>public static final</code>ã€‚</p>
<h4 id="urlconstant"><a class="markdownIt-Anchor" href="#urlconstant"></a> UrlConstant</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* URL é™æ€å¸¸é‡ç±»</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">UrlConstant</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** æ·»åŠ ç§æœ‰çš„æ„é€ å‡½æ•°ï¼Œé˜²æ­¢é™æ€å¸¸é‡ç±»æ„é€ å…¶å®ƒçš„å®ä¾‹ï¼Œç„¶åæ”¹å˜é™æ€å¸¸é‡çš„å€¼ */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">UrlConstant</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalStateException</span>(<span class="string">&quot;Utility class&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** è·³è½¬é¦–é¡µ URL */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">INDEX</span> <span class="operator">=</span> <span class="string">&quot;/index&quot;</span>;</span><br><span class="line">    <span class="comment">/** è·³è½¬æ³¨å†Œ URL */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">REGISTER</span> <span class="operator">=</span> <span class="string">&quot;/register&quot;</span>;</span><br><span class="line">    <span class="comment">/** è·³è½¬ç™»å½• URL */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">LOGIN</span> <span class="operator">=</span> <span class="string">&quot;/login&quot;</span>;</span><br><span class="line">    <span class="comment">/** è·³è½¬æŸ¥çœ‹ç”¨æˆ·åˆ—è¡¨ URL */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">VIEW</span> <span class="operator">=</span> <span class="string">&quot;/view&quot;</span>;</span><br><span class="line">    <span class="comment">/** è·³è½¬æ–°å¢ç”¨æˆ· URL */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">USER</span> <span class="operator">=</span> <span class="string">&quot;/user&quot;</span>;</span><br><span class="line">    <span class="comment">/** è·³è½¬ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯ URL */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">MODIFY</span> <span class="operator">=</span> <span class="string">&quot;/modify&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="usertypeconstant"><a class="markdownIt-Anchor" href="#usertypeconstant"></a> UserTypeConstant</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* ç”¨æˆ·ç±»å‹é™æ€å¸¸é‡ç±»</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">UserTypeConstant</span> &#123; </span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** æ·»åŠ ç§æœ‰çš„æ„é€ å‡½æ•°ï¼Œé˜²æ­¢é™æ€å¸¸é‡ç±»æ„é€ å…¶å®ƒçš„å®ä¾‹ï¼Œç„¶åæ”¹å˜é™æ€å¸¸é‡çš„å€¼ */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">UserTypeConstant</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalStateException</span>(<span class="string">&quot;Utility class&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** ç®¡ç†å‘˜ç”¨æˆ· */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">ADMIN</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** æ™®é€šç”¨æˆ· */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">ORDINARY</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·ç±»å‹ä»£ç è½¬æè¿°</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> type ç”¨æˆ·ç±»å‹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> ç”¨æˆ·ç±»å‹ä¸­æ–‡æè¿°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">typeToDesc</span><span class="params">(Sting type)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (UserTypeConstant.ADMIN.equals(type)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;ç®¡ç†å‘˜&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (UserTypeConstant.ORDINARY.equals(type)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;æ™®é€šç”¨æˆ·&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;æœªçŸ¥èº«ä»½ï¼Œè¯·è”ç³»ç³»ç»Ÿç®¡ç†å‘˜&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h4 id="imagecodeconstant"><a class="markdownIt-Anchor" href="#imagecodeconstant"></a> ImageCodeConstant</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">ImageCodeConstant</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** æ·»åŠ ç§æœ‰çš„æ„é€ å‡½æ•°ï¼Œé˜²æ­¢é™æ€å¸¸é‡ç±»æ„é€ å…¶å®ƒçš„å®ä¾‹ï¼Œç„¶åæ”¹å˜é™æ€å¸¸é‡çš„å€¼ */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">ImageCodeConstant</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalStateException</span>(<span class="string">&quot;Utility class&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** éªŒè¯ç ç”Ÿæˆçš„æ—¶é—´ */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">CODE_TIME</span> <span class="operator">=</span> <span class="string">&quot;codeTime&quot;</span>;</span><br><span class="line">    <span class="comment">/** éªŒè¯ç è¿‡æœŸæ—¶é—´ï¼Œå•ä½ï¼šåˆ†é’Ÿ */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">CAPTCHA_EXPIRY_TIME</span> <span class="operator">=</span> <span class="number">5</span>;</span><br><span class="line">    <span class="comment">/** ç§’/æ¯«ç§’æ¢ç®— */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">MILLISECOND_CONVERSION</span> <span class="operator">=</span> <span class="number">1000</span>;</span><br><span class="line">    <span class="comment">/** åˆ†é’Ÿ/ç§’æ¢ç®— */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">MINUTE_CONVERSION</span> <span class="operator">=</span> <span class="number">60</span>;</span><br><span class="line">    <span class="comment">/** ç”ŸæˆéªŒè¯ç çš„å˜é‡åç§° */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">SIMPLE_CAPTCHA</span> <span class="operator">=</span> <span class="string">&quot;simpleCaptcha&quot;</span>;</span><br><span class="line">    <span class="comment">/** ç”ŸæˆéªŒè¯ç çš„å˜é‡å€¼ */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">CAPTCHA_VALUE</span> <span class="operator">=</span> <span class="string">&quot;captchaValue&quot;</span>;</span><br><span class="line">    <span class="comment">/** ç”Ÿæˆçš„éªŒè¯ç å›¾å½¢çš„å˜é‡å */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">IMAGE</span> <span class="operator">=</span> <span class="string">&quot;image&quot;</span>;</span><br><span class="line">    <span class="comment">/** ç”Ÿæˆçš„å›¾å½¢éªŒè¯ç æ–‡ä»¶æ ¼å¼åŒ–çš„åç§° */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">JPEG</span> <span class="operator">=</span> <span class="string">&quot;JPEG&quot;</span>;</span><br><span class="line">    <span class="comment">/** å›¾ç‰‡å­—ç¬¦æ¶‰åŠçš„ç½—é©¬å­—ä½“å */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">TIMES_NEW_ROMAN</span> <span class="operator">=</span> <span class="string">&quot;Times New Roman&quot;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="respoonseconstant"><a class="markdownIt-Anchor" href="#respoonseconstant"></a> RespoonseConstant</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">ResponseConstant</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** æ·»åŠ ç§æœ‰çš„æ„é€ å‡½æ•°ï¼Œé˜²æ­¢é™æ€å¸¸é‡ç±»æ„é€ å…¶å®ƒçš„å®ä¾‹ï¼Œç„¶åæ”¹å˜é™æ€å¸¸é‡çš„å€¼ */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">ResponseConstant</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalStateException</span>(<span class="string">&quot;Utility class&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** å¤„ç†æˆåŠŸæ—¶è¿”å›çš„ Code */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">SUCCESS</span> <span class="operator">=</span> <span class="string">&quot;200&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** ä¸šåŠ¡å¤„ç†å¤±è´¥æ—¶è¿”å›çš„ Code */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">FAIL</span> <span class="operator">=</span> <span class="string">&quot;-1&quot;</span>;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/** è¿”å›ä¿¡æ¯çš„ Key å¸¸é‡å€¼ */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">RESPONSE_VO</span> <span class="operator">=</span> <span class="string">&quot;responseVO&quot;</span>;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/** è¿”å›çŠ¶æ€ç å¸¸é‡å€¼ */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">CODE</span> <span class="operator">=</span> <span class="string">&quot;code&quot;</span>;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/** è¿”å›çŠ¶æ€ä¿¡æ¯å¸¸é‡å€¼ */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">MESSAGE</span> <span class="operator">=</span> <span class="string">&quot;message&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="userconstant"><a class="markdownIt-Anchor" href="#userconstant"></a> UserConstant</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">UserConstant</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** æ·»åŠ ç§æœ‰çš„æ„é€ å‡½æ•°ï¼Œé˜²æ­¢é™æ€å¸¸é‡ç±»æ„é€ å…¶å®ƒçš„å®ä¾‹ï¼Œç„¶åæ”¹å˜é™æ€å¸¸é‡çš„å€¼ */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">UserConstant</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalStateException</span>(<span class="string">&quot;Utility class&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/** Session ä¸­çš„ç”¨æˆ·åå¸¸é‡çš„å­—æ®µåç§°ï¼Œå¤šå¤„ä½¿ç”¨ç»Ÿä¸€åœ¨è¿™é‡Œå®šä¹‰ï¼Œé¿å… SonarLint é­”æ³•å€¼çš„å‘Šè­¦ */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">USERNAME</span> <span class="operator">=</span> <span class="string">&quot;username&quot;</span>;</span><br><span class="line">    <span class="comment">/** Session ä¸­çš„ç”¨æˆ·ç±»å‹å¸¸é‡çš„å­—æ®µåç§°ï¼Œå¤šå¤„ä½¿ç”¨ç»Ÿä¸€åœ¨è¿™é‡Œå®šä¹‰ï¼Œé¿å… SonarLint é­”æ³•å€¼çš„å‘Šè­¦ */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">TYPE</span> <span class="operator">=</span> <span class="string">&quot;type&quot;</span>;</span><br><span class="line">    <span class="comment">/** Session ä¸­çš„ç”¨æˆ·ç±»å‹åç§°å¸¸é‡çš„å­—æ®µåç§°ï¼Œå¤šå¤„ä½¿ç”¨ç»Ÿä¸€åœ¨è¿™é‡Œå®šä¹‰ï¼Œé¿å… SonarLint é­”æ³•å€¼çš„å‘Šè­¦ */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">TYPE_NAME</span> <span class="operator">=</span> <span class="string">&quot;typeName&quot;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å·¥å…·ç±»"><a class="markdownIt-Anchor" href="#å·¥å…·ç±»"></a> å·¥å…·ç±»</h3>
<h4 id="md5-å¯†ç åŠ å¯†"><a class="markdownIt-Anchor" href="#md5-å¯†ç åŠ å¯†"></a> MD5 å¯†ç åŠ å¯†</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Md5Util</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Md5Util</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalStateException</span>(<span class="string">&quot;Utility class&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * md5 åŠ å¯†é€šç”¨å·¥å…·ç±»</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> encode éœ€åŠ å¯†çš„å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> md5 åŠ å¯†åçš„å­—ç¬¦ä¸²ï¼ˆ32ä½å­—ç¬¦ä¸²ï¼‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">md5</span><span class="params">(String encode)</span> &#123;</span><br><span class="line">        <span class="comment">// æ£€éªŒå‚æ•°æ˜¯å¦æ˜¯ null æˆ–è€… &quot;&quot; æˆ–è€… &quot; &quot; ç­‰</span></span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isBlank(encode)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">char</span>[] hexDigits = &#123;<span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;8&#x27;</span>, <span class="string">&#x27;9&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;f&#x27;</span>&#125;;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// è®¾ç½®å­—ç¬¦é›†</span></span><br><span class="line">            <span class="type">byte</span>[] strTemp = encode.getBytes(StandardCharsets.UTF_8);</span><br><span class="line">            <span class="comment">// ç”Ÿæˆä¸€ä¸ª md5 åŠ å¯†è®¡ç®—æ‘˜è¦</span></span><br><span class="line">            <span class="type">MessageDigest</span> <span class="variable">mdTemp</span> <span class="operator">=</span> MessageDigest.getInstance(<span class="string">&quot;MD5&quot;</span>);</span><br><span class="line">            <span class="comment">// è®¡ç®— md5 å‡½æ•°</span></span><br><span class="line">            mdTemp.update(strTemp);</span><br><span class="line">            <span class="comment">// digest() æœ€åç¡®å®šè¿”å› md5 hash å€¼ï¼Œè¿”å›å€¼ä¸º 8 ä½å­—ç¬¦ä¸²ã€‚å› ä¸º md5 hash å€¼æ˜¯ 16 ä½çš„ hex å€¼ï¼Œå®é™…ä¸Šå°±æ˜¯ 8 ä½çš„å­—ç¬¦</span></span><br><span class="line">            <span class="type">byte</span>[] md = mdTemp.digest();</span><br><span class="line">            <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> md.length;</span><br><span class="line">            <span class="type">char</span>[] str = <span class="keyword">new</span> <span class="title class_">char</span>[j * <span class="number">2</span>];</span><br><span class="line">            <span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">byte</span> byte0 : md) &#123;</span><br><span class="line">                <span class="comment">// ä¸å¸¦ç¬¦å·å³ç§»å››ä½(ä¸ç®¡ byte0 çš„ç±»å‹ ä½ç§»å¤„è¡¥ 0)ï¼Œ&amp; åå…­è¿›åˆ¶çš„ f å³ é«˜å››ä½æ¸…ç©º å–ä½å››ä½çš„å€¼ï¼Œ&gt;&gt;&gt; ä¼˜å…ˆçº§é«˜äº &amp;</span></span><br><span class="line">                str[k++] = hexDigits[byte0 &gt;&gt;&gt; <span class="number">4</span> &amp; <span class="number">0xf</span>];</span><br><span class="line">                str[k++] = hexDigits[byte0 &amp; <span class="number">0xf</span>];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>(str);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="éªŒè¯ç ç”Ÿæˆ"><a class="markdownIt-Anchor" href="#éªŒè¯ç ç”Ÿæˆ"></a> éªŒè¯ç ç”Ÿæˆ</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ImageCodeUtil</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">ImageCodeUtil</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalStateException</span>(<span class="string">&quot;Utility class&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** ç”ŸæˆéªŒè¯ç å›¾ç‰‡çš„é»˜è®¤å®½åº¦ */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">IMAGE_WIDTH</span> <span class="operator">=</span> <span class="number">60</span>;</span><br><span class="line">    <span class="comment">/** ç”ŸæˆéªŒè¯ç å›¾ç‰‡çš„é»˜è®¤é«˜åº¦ */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">IMAGE_HEIGHT</span> <span class="operator">=</span> <span class="number">20</span>;</span><br><span class="line">    <span class="comment">/** éšæœºå¹²æ‰°çº¿çš„æ¡æ•°ï¼Œå¤ªç¨€ç–æˆ–è€…å¤ªå¯†ç»‡éƒ½è¾¾ä¸åˆ°å¹²æ‰°çš„æ•ˆæœ */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">RAND_COLOR</span> <span class="operator">=</span> <span class="number">168</span>;</span><br><span class="line">    <span class="comment">/** é¢œè‰²æ•°å€¼çš„ä¸Šé™ï¼Œä¸‰åŸè‰²çš„èŒƒå›´éƒ½æ˜¯ [0, 255] èŒƒå›´ */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">COLOR_MAX</span> <span class="operator">=</span> <span class="number">255</span>;</span><br><span class="line">    <span class="comment">/** å¯æ ¹æ®éœ€è¦æ¥ä¿®æ”¹ï¼Œç”Ÿæˆçº¯æ•°å­—æˆ–è€…çº¯å­—æ¯ï¼Œæˆ–è€…é»˜è®¤è¿™ç§æ··åˆçš„ */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">char</span>[] mapTable = &#123;<span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;8&#x27;</span>, <span class="string">&#x27;9&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;E&#x27;</span>, <span class="string">&#x27;F&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;G&#x27;</span>, <span class="string">&#x27;H&#x27;</span>, <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;J&#x27;</span>, <span class="string">&#x27;K&#x27;</span>, <span class="string">&#x27;L&#x27;</span>, <span class="string">&#x27;M&#x27;</span>, <span class="string">&#x27;N&#x27;</span>, <span class="string">&#x27;O&#x27;</span>, <span class="string">&#x27;P&#x27;</span>, <span class="string">&#x27;Q&#x27;</span>, <span class="string">&#x27;R&#x27;</span>, <span class="string">&#x27;S&#x27;</span>, <span class="string">&#x27;T&#x27;</span>, <span class="string">&#x27;U&#x27;</span>, <span class="string">&#x27;V&#x27;</span>, <span class="string">&#x27;W&#x27;</span>, <span class="string">&#x27;X&#x27;</span>, <span class="string">&#x27;Y&#x27;</span>, <span class="string">&#x27;Z&#x27;</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”Ÿæˆå›¾å½¢éªŒè¯ç </span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> width ç”Ÿæˆçš„å›¾å½¢éªŒè¯ç çš„å®½åº¦</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> height ç”Ÿæˆçš„å›¾å½¢éªŒè¯ç çš„é«˜åº¦</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> verifySize éœ€è¦ç”Ÿæˆçš„éªŒè¯ç ä½æ•°</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> éªŒè¯ç çš„å›¾ç‰‡å¯¹è±¡åŠéªŒè¯ç çš„å€¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String, Object&gt; <span class="title function_">getImageCode</span><span class="params">(<span class="type">int</span> width, <span class="type">int</span> height, <span class="type">int</span> verifySize)</span></span><br><span class="line">            <span class="keyword">throws</span> NoSuchAlgorithmException &#123;</span><br><span class="line">        Map&lt;String, Object&gt; returnMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(<span class="number">6</span>);</span><br><span class="line">        <span class="comment">// ç¡®ä¿éªŒè¯ç çš„å®½åº¦å’Œé«˜åº¦ä¸èƒ½å°äºæˆ–ç­‰äºé›¶</span></span><br><span class="line">        width = width &lt;= <span class="number">0</span> ? IMAGE_WIDTH : width;</span><br><span class="line">        height = height &lt;= <span class="number">0</span> ? IMAGE_HEIGHT : height;</span><br><span class="line">        <span class="comment">// BufferedImage æ˜¯ Image çš„ä¸€ä¸ªå­ç±»ï¼ŒImage å’Œ BufferedImage</span></span><br><span class="line">        <span class="comment">// ä¸»è¦ä½œç”¨å°±æ˜¯å°†ä¸€å‰¯å›¾ç‰‡åŠ è½½åˆ°å†…å­˜ä¸­ï¼ŒBufferedImage ç”Ÿæˆçš„å›¾ç‰‡åœ¨å†…å­˜é‡Œæœ‰ä¸€ä¸ªå›¾åƒç¼“å†²åŒº</span></span><br><span class="line">        <span class="comment">// åˆ©ç”¨è¿™ä¸ªç¼“å†²åŒºæˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿çš„æ“ä½œè¿™ä¸ªå›¾ç‰‡ï¼Œé€šå¸¸ç”¨æ¥åšå›¾ç‰‡ä¿®æ”¹æ“ä½œå¦‚å¤§å°å˜æ¢ã€å›¾ç‰‡å˜ç°ã€è®¾ç½®å›¾ç‰‡é€æ˜æˆ–ä¸é€æ˜ç­‰</span></span><br><span class="line">        <span class="type">BufferedImage</span> <span class="variable">image</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedImage</span>(width, height, BufferedImage.TYPE_INT_RGB);</span><br><span class="line">        <span class="comment">// è·å–å›¾å½¢ä¸Šä¸‹æ–‡</span></span><br><span class="line">        <span class="type">Graphics</span> <span class="variable">g</span> <span class="operator">=</span> image.getGraphics();</span><br><span class="line">        <span class="comment">// ç”Ÿæˆéšæœºç±»</span></span><br><span class="line">        <span class="type">Random</span> <span class="variable">random</span> <span class="operator">=</span> SecureRandom.getInstanceStrong();</span><br><span class="line">        <span class="comment">// è®¾å®šèƒŒæ™¯è‰²</span></span><br><span class="line">        g.setColor(getRandColor(<span class="number">200</span>, <span class="number">250</span>));</span><br><span class="line">        <span class="comment">// ç”»é•¿æ–¹å½¢</span></span><br><span class="line">        g.fillRect(<span class="number">0</span>, <span class="number">0</span>, width, height);</span><br><span class="line">        <span class="comment">// è®¾å®šå­—ä½“</span></span><br><span class="line">        g.setFont(<span class="keyword">new</span> <span class="title class_">Font</span>(ImageCodeConstant.TIMES_NEW_ROMAN, Font.PLAIN, <span class="number">18</span>));</span><br><span class="line">        <span class="comment">// å†æ¬¡è®¾ç½®èƒŒæ™¯è‰²ï¼Œå®æµ‹è·Ÿå‰ä¸€æ¬¡è®¾ç½®èƒŒæ™¯è‰²æœ‰å åŠ çš„æ•ˆæœï¼Œä¼šè®©èƒŒæ™¯é¢œè‰²çœ‹èµ·æ¥æ›´å¤æ‚</span></span><br><span class="line">        g.setColor(getRandColor(<span class="number">160</span>, <span class="number">200</span>));</span><br><span class="line">        <span class="comment">// éšæœºäº§ç”Ÿ 168 æ¡å¹²æ‰°çº¿ï¼Œä½¿å›¾è±¡ä¸­çš„è®¤è¯ç ä¸æ˜“è¢«å…¶å®ƒç¨‹åºæ¢æµ‹åˆ°</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; RAND_COLOR; i++) &#123;</span><br><span class="line">            <span class="comment">// nextInt(n) ä¼šè¿”å› [0, n) ä¹‹é—´çš„éšæœºæ•°</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">x</span> <span class="operator">=</span> random.nextInt(width);</span><br><span class="line">            <span class="type">int</span> <span class="variable">y</span> <span class="operator">=</span> random.nextInt(height);</span><br><span class="line">            <span class="type">int</span> <span class="variable">xl</span> <span class="operator">=</span> random.nextInt(<span class="number">12</span>);</span><br><span class="line">            <span class="type">int</span> <span class="variable">yl</span> <span class="operator">=</span> random.nextInt(<span class="number">12</span>);</span><br><span class="line">            <span class="comment">// x: çº¿æ®µèµ·ç‚¹çš„æ¨ªåæ ‡ï¼›y: çº¿æ®µèµ·ç‚¹çš„çºµåæ ‡ï¼›x + xl: çº¿æ®µç»ˆç‚¹çš„æ¨ªåæ ‡ï¼›y + yl: çº¿æ®µç»ˆç‚¹çš„çºµåæ ‡</span></span><br><span class="line">            g.drawLine(x, y, x + xl, y + yl);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å®šä¹‰éªŒè¯ç çš„å€¼</span></span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">captchaValue</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="comment">// 4ä»£è¡¨éªŒè¯ç ä½æ•°ï¼Œå¦‚æœè¦ç”Ÿæˆæ›´å¤šä½çš„è®¤è¯ç ï¼Œåˆ™åŠ å¤§æ•°å€¼</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; verifySize; ++i) &#123;</span><br><span class="line">            captchaValue.append(mapTable[random.nextInt(mapTable.length)]);</span><br><span class="line">            <span class="comment">// å°†è®¤è¯ç æ˜¾ç¤ºåˆ°å›¾è±¡ä¸­</span></span><br><span class="line">            g.setColor(<span class="keyword">new</span> <span class="title class_">Color</span>(<span class="number">20</span> + random.nextInt(<span class="number">110</span>), <span class="number">20</span> + random.nextInt(<span class="number">110</span>), <span class="number">20</span> + random.nextInt(<span class="number">110</span>)));</span><br><span class="line">            <span class="comment">// ç›´æ¥ç”Ÿæˆ</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> captchaValue.substring(i, i + <span class="number">1</span>);</span><br><span class="line">            <span class="comment">// ä½¿ç”¨æ­¤å›¾å½¢ä¸Šä¸‹æ–‡çš„å½“å‰å­—ä½“å’Œé¢œè‰²ç»˜åˆ¶ç”±æŒ‡å®š string ç»™å®šçš„æ–‡æœ¬</span></span><br><span class="line">            g.drawString(str, <span class="number">13</span> * i + <span class="number">6</span>, <span class="number">16</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// é‡Šæ”¾å›¾å½¢ä¸Šä¸‹æ–‡èµ„æº</span></span><br><span class="line">        g.dispose();</span><br><span class="line">        <span class="comment">// ç»„è£…å›¾åƒç»“æœåŠéªŒè¯ç å€¼å¹¶è¿”å›</span></span><br><span class="line">        returnMap.put(ImageCodeConstant.IMAGE, image);</span><br><span class="line">        returnMap.put(ImageCodeConstant.CAPTCHA_VALUE, captchaValue.toString());</span><br><span class="line">        <span class="keyword">return</span> returnMap;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** ç»™å®šèŒƒå›´è·å¾—éšæœºé¢œè‰² */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Color <span class="title function_">getRandColor</span><span class="params">(<span class="type">int</span> fc, <span class="type">int</span> bc)</span> <span class="keyword">throws</span> NoSuchAlgorithmException &#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºä¸€ä¸ªéšæœºæ•°ç”Ÿæˆå¯¹è±¡çš„å®ä¾‹</span></span><br><span class="line">        <span class="type">Random</span> <span class="variable">random</span> <span class="operator">=</span> SecureRandom.getInstanceStrong();</span><br><span class="line">        <span class="comment">// é¢œè‰²å€¼ä¸èƒ½è¶…è¿‡æœ€å¤§èŒƒå›´</span></span><br><span class="line">        fc = fc &gt; COLOR_MAX ? COLOR_MAX : fc;</span><br><span class="line">        bc = bc &gt; COLOR_MAX ? COLOR_MAX : bc;</span><br><span class="line">        <span class="comment">// nextInt(n) ä¼šè¿”å› [0, n) ä¹‹é—´çš„éšæœºæ•°</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">r</span> <span class="operator">=</span> fc + random.nextInt(bc - fc);</span><br><span class="line">        <span class="type">int</span> <span class="variable">g</span> <span class="operator">=</span> fc + random.nextInt(bc - fc);</span><br><span class="line">        <span class="type">int</span> <span class="variable">b</span> <span class="operator">=</span> fc + random.nextInt(bc - fc);</span><br><span class="line">        <span class="comment">// æŒ‰éšæœºç”Ÿæˆçš„ rã€gã€b å€¼è®¾ç½®é¢œè‰²å¹¶è¿”å›</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Color</span>(r, g, b);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å®ä½“ç±»"><a class="markdownIt-Anchor" href="#å®ä½“ç±»"></a> å®ä½“ç±»</h3>
<p>å®ä½“ç±»çš„å±æ€§ä¸æ•°æ®åº“çš„å­—æ®µç›¸å¯¹åº”ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserMybatis</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** ç”¨æˆ· id */</span></span><br><span class="line">    <span class="keyword">private</span> Integer userId;</span><br><span class="line">    <span class="comment">/** ç”¨æˆ·å */</span></span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="comment">/** ç”¨æˆ·å¯†ç  */</span></span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    <span class="comment">/** ç”¨æˆ·ç±»å‹ */</span></span><br><span class="line">    <span class="keyword">private</span> String type;</span><br><span class="line">    <span class="comment">/** è®°å½•åˆ›å»ºæ—¶é—´ */</span></span><br><span class="line">    <span class="meta">@DateTimeFormat(pattern = &quot;yyyy-MM-dd HH:mm:ss&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Date gmtCreate;</span><br><span class="line">    <span class="comment">/** è®°å½•ä¿®æ”¹æ—¶é—´ */</span></span><br><span class="line">    <span class="meta">@DateTimeFormat(pattern = &quot;yyyy-MM-dd HH:mm:ss&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Date gmtModified;</span><br><span class="line">    <span class="comment">/** è®°å½•æ˜¯å¦åˆ é™¤ */</span></span><br><span class="line">    <span class="keyword">private</span> Boolean isDelete;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æ•°æ®æº"><a class="markdownIt-Anchor" href="#æ•°æ®æº"></a> æ•°æ®æº</h3>
<p>é…ç½®æ•°æ®æºï¼š</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ•°æ®æºé…ç½®</span></span><br><span class="line"><span class="comment"># serverTimezone=Asia/Shanghai è¿™ç§å†™æ³•ä¹Ÿå¯ä»¥</span></span><br><span class="line"><span class="comment"># SSL è¿æ¥å¿…é¡»æ˜¾ç¤ºçš„è¿›è¡Œé…ç½®æ˜¯å¦ä½¿ç”¨ï¼Œå¦åˆ™ä¼šæŠ¥è­¦å‘Š</span></span><br><span class="line"><span class="comment"># ä½¿ç”¨ MySQL80 æœåŠ¡ mysql-connector-java:8.0.19 ç‰ˆæœ¬çš„è¿æ¥ Jar åŒ… DriverClassï¼šcom.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="attr">spring.datasource.url</span>=<span class="string">jdbc:mysql://localhost:3306/springboot_user?serverTimezone=GMT%2B8&amp;useUnicode=true&amp;characterEncoding=utf8&amp;useSSL=false</span></span><br><span class="line"><span class="attr">spring.datasource.username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">spring.datasource.password</span>=<span class="string">123456</span></span><br><span class="line"><span class="attr">spring.datasource.driverClassName</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br></pre></td></tr></table></figure>
<p>æµ‹è¯•æ•°æ®æºæ˜¯å¦é…ç½®æˆåŠŸï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RunWith(SpringRunner.class)</span></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">JavaSpringWingoApplicationTests</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æµ‹è¯• DataSource æ˜¯å¦è¢«æˆåŠŸæ³¨å…¥</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    DataSource dataSource;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">testDataSource</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(dataSource.getClass());</span><br><span class="line">        <span class="comment">// è¾“å‡ºç»“æœ class com.zaxxer.hikari.HikariDataSource Spring Boot 2 çš„é»˜è®¤è¿æ¥æ±  Hikari</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="druid-è¿æ¥æ± "><a class="markdownIt-Anchor" href="#druid-è¿æ¥æ± "></a> Druid è¿æ¥æ± </h4>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- æ”¯æŒé˜¿é‡Œ Druid è¿æ¥æ±  --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- æ–¹å¼ä¸€ï¼šä½¿ç”¨ Spring Boot æä¾›çš„å¯åŠ¨å™¨ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- æ–¹å¼äºŒï¼šæ­¤æ–¹å¼éœ€è¦è‡ªè¡Œç¼–å†™ Druid é…ç½®ç±»å¼•å…¥é…ç½® --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- &lt;version&gt;1.1.16&lt;/version&gt; æ­¤ç‰ˆæœ¬æ‰¾ä¸åˆ°ä¾èµ– --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="druid-é…ç½®"><a class="markdownIt-Anchor" href="#druid-é…ç½®"></a> Druid é…ç½®</h4>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## Druidè¿æ¥æ± é…ç½®</span></span><br><span class="line"><span class="attr">spring.datasource.type</span>=<span class="string">com.alibaba.druid.pool.DruidDataSource</span></span><br><span class="line"><span class="comment">## Druid è¿æ¥æ± é…ç½®</span></span><br><span class="line"><span class="attr">spring.datasource.type</span>=<span class="string">com.alibaba.druid.pool.DruidDataSource</span></span><br><span class="line"><span class="comment"># åˆå§‹åŒ–å¤§å°ã€æœ€å°ã€æœ€å¤§</span></span><br><span class="line"><span class="attr">spring.datasource.initialSize</span>=<span class="string">1</span></span><br><span class="line"><span class="attr">spring.datasource.minIdle</span>=<span class="string">3</span></span><br><span class="line"><span class="attr">spring.datasource.maxActive</span>=<span class="string">20</span></span><br><span class="line"><span class="comment"># è·å–è¿æ¥ç­‰å¾…è¶…æ—¶æ—¶é—´</span></span><br><span class="line"><span class="attr">spring.datasource.maxWait</span>=<span class="string">60000</span></span><br><span class="line"><span class="comment"># é…ç½®é—´éš”å¤šä¹…æ‰è¿›è¡Œä¸€æ¬¡æ£€æµ‹ï¼Œæ£€æµ‹éœ€è¦å…³é—­çš„ç©ºé—²è¿æ¥ï¼Œå•ä½æ˜¯æ¯«ç§’</span></span><br><span class="line"><span class="attr">spring.datasource.timeBetweenEvictionRunsMillis</span>=<span class="string">30000</span></span><br><span class="line"><span class="comment"># æŒ‡å®šè·å–è¿æ¥æ—¶è¿æ¥æ ¡éªŒçš„sqlæŸ¥è¯¢è¯­å¥</span></span><br><span class="line"><span class="attr">spring.datasource.validationQuery</span>=<span class="string">select &#x27;x&#x27;</span></span><br><span class="line"><span class="comment"># è·å–è¿æ¥åï¼Œç¡®å®æ˜¯å¦è¦è¿›è¡Œè¿æ¥ç©ºé—²æ—¶é—´çš„æ£€æŸ¥</span></span><br><span class="line"><span class="attr">spring.datasource.testWhileIdle</span>=<span class="string">true</span></span><br><span class="line"><span class="comment"># è·å–è¿æ¥æ£€æµ‹</span></span><br><span class="line"><span class="attr">spring.datasource.testOnBorrow</span>=<span class="string">false</span></span><br><span class="line"><span class="comment"># å½’è¿˜è¿æ¥æ£€æµ‹</span></span><br><span class="line"><span class="attr">spring.datasource.testOnReturn</span>=<span class="string">false</span></span><br><span class="line"><span class="comment"># æŒ‡å®šè¿æ¥æ ¡éªŒæŸ¥è¯¢çš„è¶…æ—¶æ—¶é—´</span></span><br><span class="line"><span class="attr">spring.datasource.validationQueryTimeout</span>=<span class="string">600000</span></span><br><span class="line"><span class="comment"># é…ç½®ä¸€ä¸ªè¿æ¥åœ¨æ± æ€»æœ€å°ç”Ÿå­˜çš„æ—¶é—´</span></span><br><span class="line"><span class="attr">spring.datasource.minEvictableIdleTimeMillis</span>=<span class="string">300000</span></span><br><span class="line"><span class="comment"># æ‰“å¼€ PSCacheï¼Œå¹¶ä¸”æŒ‡å®šæ¯ä¸ªè¿æ¥ä¸Š Cache çš„å¤§å°</span></span><br><span class="line"><span class="attr">spring.datasource.poolPreparedStatements</span>=<span class="string">true</span></span><br><span class="line"><span class="attr">spring.datasource.maxPoolPreparedStatementPerConnectionSize</span>=<span class="string">20</span></span><br><span class="line"><span class="comment"># é…ç½®ç›‘æ§ç»Ÿè®¡æ‹¦æˆªçš„ filterï¼Œå»æ‰åç›‘æ§ç•Œé¢ sql æ— æ³•ç»Ÿè®¡ï¼Œwall ç”¨äºé˜²ç«å¢™ï¼Œstat ç”¨äºç›‘æ§ç»Ÿè®¡</span></span><br><span class="line"><span class="attr">spring.datasource.filters</span>=<span class="string">stat,wall,slf4j</span></span><br><span class="line"><span class="comment"># é€šè¿‡ connectProperties å±æ€§æ¥æ‰“å¼€ mergeSql åŠŸèƒ½ï¼Œæ…¢ sql è®°å½•ç­‰</span></span><br><span class="line"><span class="attr">spring.datasource.connectionProperties</span>=<span class="string">druid.stat.mergeSql=true;druid.stat.logSlowSql=true;druid.stat.slowSqlMillis=5000</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">## druidè¿æ¥æ± ç›‘æ§ è®¿é—® URLï¼šlocahost:8080/druid </span></span><br><span class="line"><span class="comment"># éœ€è¦è´¦å·å¯†ç æ‰èƒ½è®¿é—®æ§åˆ¶å°ï¼Œé»˜è®¤ä¸ºroot</span></span><br><span class="line"><span class="attr">spring.datasource.druid.stat-view-servlet.login-username</span>=<span class="string">admin</span></span><br><span class="line"><span class="attr">spring.datasource.druid.stat-view-servlet.login-password</span>=<span class="string">123</span></span><br><span class="line"><span class="comment"># è®¿é—®è·¯å¾„ä¸º/druidæ—¶ï¼Œè·³è½¬åˆ°StatViewServlet</span></span><br><span class="line"><span class="attr">spring.datasource.druid.stat-view-servlet.url-pattern</span>=<span class="string">/druid/*</span></span><br><span class="line"><span class="comment"># æ˜¯å¦èƒ½å¤Ÿé‡ç½®æ•°æ®</span></span><br><span class="line"><span class="attr">spring.datasource.druid.stat-view-servlet.reset-enable</span>=<span class="string">false</span></span><br><span class="line"><span class="comment"># æ’é™¤ä¸€äº›é™æ€èµ„æºï¼Œä»¥æé«˜æ•ˆç‡</span></span><br><span class="line"><span class="attr">spring.datasource.druid.web-stat-filter.exclusions</span>=<span class="string">*.js,*.gif,*.jpg,*.png,*.css,*.ico,/druid/*</span></span><br></pre></td></tr></table></figure>
<p>å†æ¬¡æµ‹è¯•æ§åˆ¶å°è¾“å‡ºçš„ DataSource çš„ç±»å‹ä¸º com.alibaba.druid.pool.DruidDataSourceã€‚</p>
<h3 id="æ•´åˆ-mybatis"><a class="markdownIt-Anchor" href="#æ•´åˆ-mybatis"></a> æ•´åˆ Mybatis</h3>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- æ”¯æŒ MyBatis --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="é…ç½®-mapper"><a class="markdownIt-Anchor" href="#é…ç½®-mapper"></a> é…ç½® Mapper</h4>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## MyBatis é…ç½®</span></span><br><span class="line"><span class="comment"># é…ç½®åˆ«å parameterType ç›´æ¥ä½¿ç”¨ç±»å</span></span><br><span class="line"><span class="attr">mybatis.typeAliasesPackage</span>=<span class="string">com.wingo.user.entity</span></span><br><span class="line"><span class="attr">mybatis.mapperLocations</span>=<span class="string">classpath:mapping/*.xml</span></span><br><span class="line"><span class="comment"># æ‰“å° MyBatis æ‰§è¡Œçš„ SQL æ‰“å°å‡ºæ¥</span></span><br><span class="line"><span class="attr">mybatis.configuration.log-impl</span>=<span class="string">org.apache.ibatis.logging.stdout.StdOutImpl</span></span><br></pre></td></tr></table></figure>
<p>Mybatis ç¼–å†™æ•°æ®åº“æ“ä½œçš„æ–¹æ³•å¯¹åº”çš„ XxxMapper.java æ¥å£ç±»ï¼Œä»¥åŠå¯¹åº”çš„ XxxMapper.xml é…ç½®ç±»ï¼Œé…ç½®ç±»ç”¨äºç¼–å†™å…·ä½“çš„ SQL è¯­å¥ä»¥ä¾¿ Mybatis è¿›è¡ŒåŠ¨æ€å®ç°ã€‚</p>
<h4 id="mapper-æ¥å£ç±»"><a class="markdownIt-Anchor" href="#mapper-æ¥å£ç±»"></a> Mapper æ¥å£ç±»</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¹Ÿå¯é€šè¿‡åœ¨ Spring Boot è¿è¡Œç±»ä¸Šæ·»åŠ  @MapperScan() æ³¨è§£æ‰«æ</span></span><br><span class="line"><span class="meta">@Mapper</span> <span class="comment">// æ‰«ææ­¤ç±»ä¸º Mybatis çš„ mapper ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserMybatisMapper</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·æ³¨å†Œ / æ·»åŠ ç”¨æˆ·ï¼šåœ¨æ•°æ®åº“ä¸­æ·»åŠ ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> userMybatis ç”¨æˆ·</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">insert</span><span class="params">(UserMybatis userMybatis)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·ç™»å½•ï¼šé€šè¿‡ç”¨æˆ·åã€ç”¨æˆ·å¯†ç å’Œç”¨æˆ·ç±»å‹æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> username ç”¨æˆ·å</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> password ç”¨æˆ·å¯†ç </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> type ç”¨æˆ·ç±»å‹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    UserMybatis <span class="title function_">findUserMybatisByUsernameAndPasswordAndType</span><span class="params">(String username, String password, String type)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç®¡ç†å‘˜ç”¨æˆ·ç®¡ç†é¡µé¢ï¼šé€šè¿‡ç”¨æˆ·ç±»å‹å’Œç”¨æˆ·çŠ¶æ€æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> type ç”¨æˆ·ç±»å‹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> isDelete ç”¨æˆ·çŠ¶æ€</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    List&lt;UserMybatis&gt; <span class="title function_">findAllByTypeAndStatus</span><span class="params">(String type, Integer isDelete)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·ä¿®æ”¹å¯†ç ï¼šé€šè¿‡ç”¨æˆ·åå’Œç”¨æˆ·ç±»ä¿®æ”¹ç”¨æˆ·å¯†ç </span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> password ç”¨æˆ·å¯†ç </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> username ç”¨æˆ·å</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> type ç”¨æˆ·ç±»å‹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> gmtModified ç”¨æˆ·ä¿®æ”¹æ—¶é—´</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">updatePasswordByUsernameAndType</span><span class="params">(String password, String username, String type, Date gmtModified)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ›´æ–°ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> userMybatis ç”¨æˆ·</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">update</span><span class="params">(UserMybatis userMybatis)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *ç®¡ç†å‘˜åˆ é™¤ç”¨æˆ·ï¼šé€šè¿‡ç”¨æˆ·æ ‡è¯†æ›´æ–°ç”¨æˆ·çŠ¶æ€</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> userId ç”¨æˆ·æ ‡è¯†</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> gmtModified ç”¨æˆ·ä¿®æ”¹æ—¶é—´</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">updateStatusByUserId</span><span class="params">(Integer userId, Date gmtModified)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€šè¿‡ç”¨æˆ·åå’Œç”¨æˆ·ç±»å‹æŸ¥æ‰¾ç”¨æˆ·</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> username ç”¨æˆ·å</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> type ç”¨æˆ·ç±»å‹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    UserMybatis <span class="title function_">findUserMybatisByUsernameAndType</span><span class="params">(String username, String type)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="mapper-é…ç½®å®ç°"><a class="markdownIt-Anchor" href="#mapper-é…ç½®å®ç°"></a> Mapper é…ç½®å®ç°</h4>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span> <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.wingo.user.mapper.UserMybatisMapper&quot;</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- ç¼–å†™å­—æ®µä¸å±æ€§çš„æ˜ å°„å…³ç³» --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;BaseResultMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;com.wingo.user.entity.UserMybatis&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;user_id&quot;</span> <span class="attr">jdbcType</span>=<span class="string">&quot;INTEGER&quot;</span> <span class="attr">property</span>=<span class="string">&quot;userId&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;username&quot;</span> <span class="attr">jdbcType</span>=<span class="string">&quot;VARCHAR&quot;</span> <span class="attr">property</span>=<span class="string">&quot;username&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;password&quot;</span> <span class="attr">jdbcType</span>=<span class="string">&quot;VARCHAR&quot;</span> <span class="attr">property</span>=<span class="string">&quot;password&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;type&quot;</span> <span class="attr">jdbcType</span>=<span class="string">&quot;CHAR&quot;</span> <span class="attr">property</span>=<span class="string">&quot;type&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;gmt_create&quot;</span> <span class="attr">jdbcType</span>=<span class="string">&quot;TIMESTAMP&quot;</span> <span class="attr">property</span>=<span class="string">&quot;gmtCreate&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;gmt_modified&quot;</span> <span class="attr">jdbcType</span>=<span class="string">&quot;TIMESTAMP&quot;</span> <span class="attr">property</span>=<span class="string">&quot;gmtModified&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;is_delete&quot;</span> <span class="attr">jdbcType</span>=<span class="string">&quot;BIT&quot;</span> <span class="attr">property</span>=<span class="string">&quot;isDelete&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;insert&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;UserMybatis&quot;</span> <span class="attr">keyProperty</span>=<span class="string">&quot;userId&quot;</span> <span class="attr">useGeneratedKeys</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">        INSERT INTO</span><br><span class="line">            user (user_id, username, password,type, gmt_create, gmt_modified, is_delete)</span><br><span class="line">        VALUES</span><br><span class="line">            (#&#123;userId&#125;, #&#123;username&#125;, #&#123;password&#125;, #&#123;type&#125;, #&#123;gmtCreate&#125;, #&#123;gmtModified&#125;, #&#123;isDelete&#125;)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findUserMybatisByUsernameAndPasswordAndType&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;BaseResultMap&quot;</span>&gt;</span></span><br><span class="line">        SELECT</span><br><span class="line">            user_id, username, password, type, gmt_create, gmt_modified, is_delete</span><br><span class="line">        FROM</span><br><span class="line">            user</span><br><span class="line">        WHERE</span><br><span class="line">            username = #&#123;username&#125;</span><br><span class="line">        AND</span><br><span class="line">            password = #&#123;password&#125;</span><br><span class="line">        AND</span><br><span class="line">            type = #&#123;type&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findAllByTypeAndStatus&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;BaseResultMap&quot;</span>&gt;</span></span><br><span class="line">        SELECT</span><br><span class="line">            user_id, username, password, type, gmt_create, gmt_modified, is_delete</span><br><span class="line">        FROM</span><br><span class="line">             user</span><br><span class="line">        WHERE</span><br><span class="line">            type = #&#123;type&#125;</span><br><span class="line">        AND</span><br><span class="line">            is_delete = #&#123;isDelete&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findUserMybatisByUsernameAndType&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;BaseResultMap&quot;</span>&gt;</span></span><br><span class="line">        SELECT</span><br><span class="line">            user_id, username, password, type, gmt_create, gmt_modified, is_delete</span><br><span class="line">        FROM</span><br><span class="line">             user</span><br><span class="line">        WHERE</span><br><span class="line">            username = #&#123;username&#125;</span><br><span class="line">        AND</span><br><span class="line">            type = #&#123;type&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;update&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;UserMybatis&quot;</span>&gt;</span></span><br><span class="line">        UPDATE</span><br><span class="line">            user</span><br><span class="line">        <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;username != null&quot;</span>&gt;</span></span><br><span class="line">                username = #&#123;username&#125;,</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;password != null&quot;</span>&gt;</span></span><br><span class="line">                password = #&#123;password&#125;,</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;type != null&quot;</span>&gt;</span></span><br><span class="line">                type = #&#123;type&#125;,</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;gmtCreate != null&quot;</span>&gt;</span></span><br><span class="line">                gmt_create = #&#123;gmtCreate&#125;,</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;gmtModified != null&quot;</span>&gt;</span></span><br><span class="line">                gmt_modified = #&#123;gmtModified&#125;,</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;isDelete != null&quot;</span>&gt;</span></span><br><span class="line">                is_delete = #&#123;isDelete&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">        WHERE</span><br><span class="line">            user_id = #&#123;userId&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;updatePasswordByUsernameAndType&quot;</span>&gt;</span></span><br><span class="line">        UPDATE</span><br><span class="line">            user</span><br><span class="line">        SET</span><br><span class="line">            password = #&#123;password&#125;, gmt_modified = #&#123;gmtModified&#125;</span><br><span class="line">        where</span><br><span class="line">            username =#&#123;username&#125;</span><br><span class="line">        and</span><br><span class="line">            type = #&#123;type&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;updateStatusByUserId&quot;</span>&gt;</span></span><br><span class="line">        UPDATE</span><br><span class="line">            user</span><br><span class="line">        SET</span><br><span class="line">            is_delete = true, gmt_modified = #&#123;gmtModified&#125;</span><br><span class="line">        WHERE</span><br><span class="line">            user_id = #&#123;userId&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="ç¼–å†™æµ‹è¯•æ–¹æ³•"><a class="markdownIt-Anchor" href="#ç¼–å†™æµ‹è¯•æ–¹æ³•"></a> ç¼–å†™æµ‹è¯•æ–¹æ³•</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RunWith(SpringRunner.class)</span></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JavaSpringWingoApplicationTests</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    UserMybatisMapper userMybatisMapper;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@Rollback</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testInsert</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">Date</span> <span class="variable">date</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">        <span class="type">UserMybatis</span> <span class="variable">userMybatis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserMybatis</span>();</span><br><span class="line">        userMybatis.setUsername(<span class="string">&quot;å¼ ä¸‰&quot;</span>);</span><br><span class="line">        userMybatis.setPassword(<span class="string">&quot;123456&quot;</span>);</span><br><span class="line">        userMybatis.setType(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">        userMybatis.setGmtCreate(date);</span><br><span class="line">        userMybatis.setGmtModified(date);</span><br><span class="line">        userMybatis.setIsDelete(<span class="literal">false</span>);</span><br><span class="line">        userMybatisMapper.insert(userMybatis);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** </span></span><br><span class="line"><span class="comment">    * UserMybatis userMybatis = userMybatisMapper.</span></span><br><span class="line"><span class="comment">    *	findUserMybatisByUsernameAndPasswordAndType(&quot;å¼ ä¸‰&quot;,&quot;123456&quot;,&quot;0&quot;);</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * List&lt;UserMybatis&gt; list = new ArrayList&lt;&gt;();</span></span><br><span class="line"><span class="comment">    * list = userMybatisMapper.findAllByTypeAndStatus(&quot;0&quot;,0);</span></span><br><span class="line"><span class="comment">    * Iterator&lt;UserMybatis&gt; iterable = list.iterator();</span></span><br><span class="line"><span class="comment">    * while (iterable.hasNext())&#123;</span></span><br><span class="line"><span class="comment">    * 	UserMybatis userMybatis = iterable.next();</span></span><br><span class="line"><span class="comment">    * 	System.out.println(userMybatis);</span></span><br><span class="line"><span class="comment">    * &#125;</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * UserMybatis userMybatis = userMybatisMapper.findUserMybatisByUsernameAndType(&quot;å¼ ä¸‰&quot;,&quot;0&quot;);</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * UserMybatis userMybatis = new UserMybatis();</span></span><br><span class="line"><span class="comment">    * userMybatis.setUserId(6);</span></span><br><span class="line"><span class="comment">    * userMybatis.setUsername(&quot;æå››&quot;);</span></span><br><span class="line"><span class="comment">    * int result = userMybatisMapper.update(userMybatis);</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * Date date = new Date();</span></span><br><span class="line"><span class="comment">    * userMybatisMapper.updatePasswordByUsernameAndType(&quot;654321&quot;,&quot;æå››&quot;,&quot;0&quot;,date);</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * Date date = new Date();</span></span><br><span class="line"><span class="comment">    * userMybatisMapper.updateStatusByUserId(6,date);</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ä¸šåŠ¡é€»è¾‘å±‚"><a class="markdownIt-Anchor" href="#ä¸šåŠ¡é€»è¾‘å±‚"></a> ä¸šåŠ¡é€»è¾‘å±‚</h3>
<h4 id="mybatis-ç‰ˆæœ¬"><a class="markdownIt-Anchor" href="#mybatis-ç‰ˆæœ¬"></a> Mybatis ç‰ˆæœ¬</h4>
<p>ç¼–å†™é¡¹ç›®åœºæ™¯åŠŸèƒ½çš„ä¸šåŠ¡é€»è¾‘ï¼šæ¥æ”¶å‰ç«¯ä¼ æ¥çš„ä¿¡æ¯æ‰€å°ä½çš„ DTOï¼Œç„¶åè°ƒç”¨ DAO è¿›è¡Œä¸šåŠ¡é€»è¾‘çš„ç¼–å†™ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service(&quot;userServiceMybatisImpl&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceMybatisImpl</span> <span class="keyword">implements</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span></span><br><span class="line">    UserMybatisMapper userMybatisMapper;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">UserServiceMybatisImpl</span><span class="params">(UserMybatisMapper userMybatisMapper)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.userMybatisMapper = userMybatisMapper;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ£€æŸ¥æ­¤ç”¨æˆ·æ˜¯å¦å·²ç»å­˜åœ¨</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> username ç”¨æˆ·å</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">checkUserDuplicate</span><span class="params">(String username)</span>&#123;</span><br><span class="line">        <span class="comment">// å®šä¹‰é»˜è®¤è¿”å› false</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">isDuplicate</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="type">UserMybatis</span> <span class="variable">userMybatis</span> <span class="operator">=</span> userMybatisMapper.findUserMybatisByUsernameAndType(username, UserTypeConstant.ORDINARY);</span><br><span class="line">        <span class="comment">// è‹¥æ­¤ç”¨æˆ·å­˜åœ¨ï¼Œåˆ™è¿”å› true</span></span><br><span class="line">        <span class="keyword">if</span>(userMybatis!=<span class="literal">null</span>)&#123;</span><br><span class="line">            isDuplicate = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> isDuplicate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> UserMybatis <span class="title function_">buildUserMybatis</span><span class="params">(String username, String password)</span>&#123;</span><br><span class="line">        <span class="type">Date</span> <span class="variable">data</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">        <span class="comment">// åˆ›å»ºç”¨æˆ·å®ä½“å¯¹è±¡å¹¶è¿›è¡Œèµ‹å€¼</span></span><br><span class="line">        <span class="type">UserMybatis</span> <span class="variable">userMybatis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserMybatis</span>();</span><br><span class="line">        userMybatis.setUsername(username);</span><br><span class="line">        userMybatis.setPassword(Md5Util.md5(password));</span><br><span class="line">        userMybatis.setType(UserTypeConstant.ORDINARY);</span><br><span class="line">        userMybatis.setGmtCreate(data);</span><br><span class="line">        userMybatis.setGmtModified(data);</span><br><span class="line">        userMybatis.setIsDelete(<span class="literal">false</span>);</span><br><span class="line">        <span class="keyword">return</span> userMybatis;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** ç”¨æˆ·æ³¨å†Œ */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@Transactional(rollbackFor = Exception.class)</span></span><br><span class="line">    <span class="keyword">public</span> ResponseVO <span class="title function_">register</span><span class="params">(RegisterDTO registerDTO)</span> &#123;</span><br><span class="line">        <span class="comment">// å®šä¹‰è¿”å›å¯¹è±¡</span></span><br><span class="line">        <span class="type">ResponseVO</span> <span class="variable">responseVO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ResponseVO</span>();</span><br><span class="line">        <span class="comment">// æ£€æŸ¥æ­¤ç”¨æˆ·æ˜¯å¦æ˜¯å¦å·²ç»å­˜åœ¨</span></span><br><span class="line">        <span class="keyword">if</span>(checkUserDuplicate(registerDTO.getUsername()))&#123;</span><br><span class="line">            <span class="comment">// ç»„è£…é”™è¯¯è¿”å›å¯¹è±¡</span></span><br><span class="line">            responseVO.fail(<span class="string">&quot;ç”¨æˆ·åé‡å¤ï¼Œè¯·é‡æ–°æ³¨å†Œï¼&quot;</span>);</span><br><span class="line">            <span class="comment">// è¿”å›é”™è¯¯ä»£ç åŠé”™è¯¯ä¿¡æ¯</span></span><br><span class="line">            <span class="keyword">return</span> responseVO;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// åˆ›å»ºç”¨æˆ·å®ä½“å¯¹è±¡å¹¶è¿›è¡Œèµ‹å€¼</span></span><br><span class="line">        <span class="type">UserMybatis</span> <span class="variable">userMybatis</span> <span class="operator">=</span> buildUserMybatis(registerDTO.getUsername(), registerDTO.getPassword());</span><br><span class="line">        <span class="comment">// ä¿å­˜æ•°æ®åˆ°æ•°æ®åº“</span></span><br><span class="line">        userMybatisMapper.insert(userMybatis);</span><br><span class="line">        <span class="comment">// ç»„è£…æˆåŠŸè¿”å›å¯¹è±¡</span></span><br><span class="line">        responseVO.success(<span class="string">&quot;æ­å–œæ‚¨ï¼Œæ³¨å†ŒæˆåŠŸï¼è¯·ç™»å½•&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> responseVO;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** ç”¨æˆ·ç™»å½• */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> ResponseVO <span class="title function_">login</span><span class="params">(LoginDTO loginDTO)</span> &#123;</span><br><span class="line">        <span class="type">ResponseVO</span> <span class="variable">responseVO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ResponseVO</span>();</span><br><span class="line">        <span class="type">UserMybatis</span> <span class="variable">userMybatis</span> <span class="operator">=</span> userMybatisMapper.findUserMybatisByUsernameAndPasswordAndType</span><br><span class="line">                        (loginDTO.getUsername(), Md5Util.md5(loginDTO.getPassword()), loginDTO.getType());</span><br><span class="line">        <span class="keyword">if</span>(userMybatis == <span class="literal">null</span>)&#123;</span><br><span class="line">            responseVO.fail(<span class="string">&quot;ç™»å½•å¤±è´¥ï¼Œç”¨æˆ·ä¸å­˜åœ¨ã€å·²åˆ é™¤æˆ–è€…ç”¨æˆ·åã€å¯†ç æˆ–ç±»å‹é€‰æ‹©é”™è¯¯ï¼&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> responseVO;</span><br><span class="line">        &#125;</span><br><span class="line">        responseVO.success(<span class="string">&quot;ç™»å½•æˆåŠŸï¼&quot;</span>);</span><br><span class="line">        <span class="comment">// æ„å»ºè¿”å›çš„ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">        <span class="type">UserVO</span> <span class="variable">userVO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserVO</span>();</span><br><span class="line">        userVO.setUsername(loginDTO.getUsername());</span><br><span class="line">        userVO.setType(loginDTO.getType());</span><br><span class="line">        responseVO.setData(<span class="string">&quot;userVO&quot;</span>, userVO);</span><br><span class="line">        <span class="keyword">return</span> responseVO;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** ç®¡ç†å‘˜æ·»åŠ ç”¨æˆ· */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@Transactional(rollbackFor = Exception.class)</span></span><br><span class="line">    <span class="keyword">public</span> ResponseVO <span class="title function_">add</span><span class="params">(AddDTO addDTO)</span> &#123;</span><br><span class="line">        <span class="comment">// å®šä¹‰è¿”å›å¯¹è±¡</span></span><br><span class="line">        <span class="type">ResponseVO</span> <span class="variable">responseVO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ResponseVO</span>();</span><br><span class="line">        <span class="comment">// æ£€æŸ¥æ­¤ç”¨æˆ·æ˜¯å¦æ˜¯å¦å·²ç»å­˜åœ¨</span></span><br><span class="line">        <span class="keyword">if</span>(checkUserDuplicate(addDTO.getUsername()))&#123;</span><br><span class="line">            <span class="comment">// ç»„è£…é”™è¯¯è¿”å›å¯¹è±¡</span></span><br><span class="line">            responseVO.fail(<span class="string">&quot;ç”¨æˆ·åé‡å¤ï¼Œè¯·é‡æ–°æ·»åŠ ï¼&quot;</span>);</span><br><span class="line">            <span class="comment">// è¿”å›é”™è¯¯ä»£ç åŠé”™è¯¯ä¿¡æ¯</span></span><br><span class="line">            <span class="keyword">return</span> responseVO;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// åˆ›å»ºç”¨æˆ·å®ä½“å¯¹è±¡å¹¶è¿›è¡Œèµ‹å€¼</span></span><br><span class="line">        <span class="type">UserMybatis</span> <span class="variable">userMybatis</span> <span class="operator">=</span> buildUserMybatis(addDTO.getUsername(), addDTO.getPassword());</span><br><span class="line">        <span class="comment">// ä¿å­˜æ•°æ®åˆ°æ•°æ®åº“</span></span><br><span class="line">        userMybatisMapper.insert(userMybatis);</span><br><span class="line">        <span class="comment">// ç»„è£…æˆåŠŸè¿”å›å¯¹è±¡</span></span><br><span class="line">        responseVO.success(<span class="string">&quot;æ·»åŠ æˆåŠŸï¼&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> responseVO;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** ç®¡ç†å‘˜æŸ¥çœ‹ç”¨æˆ·åˆ—è¡¨ */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> ResponseVO <span class="title function_">view</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">ResponseVO</span> <span class="variable">responseVO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ResponseVO</span>();</span><br><span class="line">        <span class="comment">// å®šä¹‰è¿”å›çš„ç»“æœé›†å¯¹è±¡ï¼Œè¿™ç§å®šä¹‰æ–¹å¼æ˜¯å¯¹è±¡å½¢å¼çš„é›†åˆ</span></span><br><span class="line">        List&lt;ViewVO&gt; userList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        List&lt;UserMybatis&gt; userMybatisList = userMybatisMapper.findAllByTypeAndStatus(UserTypeConstant.ORDINARY, <span class="literal">false</span>);</span><br><span class="line">        <span class="keyword">if</span>(userMybatisList == <span class="literal">null</span>)&#123;</span><br><span class="line">            responseVO.fail(<span class="string">&quot;è¯·æ±‚ç”¨æˆ·åˆ—è¡¨å¤±è´¥ï¼&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> responseVO;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(UserMybatis userMybatis : userMybatisList)&#123;</span><br><span class="line">            <span class="comment">// åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡æ¥å­˜å‚¨æŸ¥è¯¢å‡ºçš„ä¸€æ¡æ¡è®°å½•</span></span><br><span class="line">            <span class="type">ViewVO</span> <span class="variable">viewVO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ViewVO</span>();</span><br><span class="line">            <span class="comment">// å¯¹å¯¹è±¡è¿›è¡Œèµ‹å€¼</span></span><br><span class="line">            viewVO.setUserId(userMybatis.getUserId());</span><br><span class="line">            viewVO.setUsername(userMybatis.getUsername());</span><br><span class="line">            viewVO.setType(userMybatis.getType());</span><br><span class="line">            viewVO.setGtmCreate(userMybatis.getGmtCreate());</span><br><span class="line">            <span class="comment">// å°†å¯¹è±¡æ”¾å…¥é›†åˆä¸­</span></span><br><span class="line">            userList.add(viewVO);</span><br><span class="line">        &#125;</span><br><span class="line">        responseVO.success(<span class="string">&quot;è¯·æ±‚ç”¨æˆ·åˆ—è¡¨æˆåŠŸï¼&quot;</span>);</span><br><span class="line">        responseVO.setData(<span class="string">&quot;viewVO&quot;</span>, userList);</span><br><span class="line">        <span class="keyword">return</span> responseVO;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** ç”¨æˆ·ä¿®æ”¹å¯†ç  */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@Transactional(rollbackFor = Exception.class)</span></span><br><span class="line">    <span class="keyword">public</span> ResponseVO <span class="title function_">modify</span><span class="params">(ModifyDTO modifyDTO)</span> &#123;</span><br><span class="line">        <span class="type">ResponseVO</span> <span class="variable">responseVO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ResponseVO</span>();</span><br><span class="line">        <span class="comment">// åˆ¤æ–­æ˜¯å¦æœ‰æ–°å¯†ç ä¸”æ–°æ—§å¯†ç æ˜¯å¦ä¸€è‡´</span></span><br><span class="line">        <span class="keyword">if</span>(modifyDTO.getNewPassword() != <span class="literal">null</span> &amp;&amp; modifyDTO.getConfirmNewPassword() != <span class="literal">null</span></span><br><span class="line">                &amp;&amp; !modifyDTO.getConfirmNewPassword().equals(modifyDTO.getNewPassword()))&#123;</span><br><span class="line">            responseVO.fail(<span class="string">&quot;æ–°å¯†ç å’Œç¡®è®¤æ–°å¯†ç ä¸ä¸€è‡´ï¼Œè¯·æ£€æŸ¥ï¼&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> responseVO;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// åˆ¤æ–­ç”¨æˆ·çš„åŸå¯†ç æ˜¯å¦æ­£ç¡®</span></span><br><span class="line">        <span class="type">UserMybatis</span> <span class="variable">userMybatis</span> <span class="operator">=</span> userMybatisMapper.findUserMybatisByUsernameAndPasswordAndType(</span><br><span class="line">                modifyDTO.getUsername(), Md5Util.md5(modifyDTO.getPassword()), modifyDTO.getType()</span><br><span class="line">        );</span><br><span class="line">        <span class="keyword">if</span>(userMybatis == <span class="literal">null</span>)&#123;</span><br><span class="line">            responseVO.fail(<span class="string">&quot;ç”¨æˆ·åŸå¯†ç ä¸æ­£ç¡®ï¼Œè¯·æ£€æŸ¥ï¼&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> responseVO;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Date</span> <span class="variable">date</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">        <span class="comment">// ç¡®è®¤æ»¡è¶³ä¿®æ”¹æ¡ä»¶åå¯¹ç”¨æˆ·ä¿¡æ¯è¿›è¡Œæ›´æ–°</span></span><br><span class="line">        userMybatis.setPassword(Md5Util.md5(modifyDTO.getNewPassword()));</span><br><span class="line">        userMybatis.setGmtModified(date);</span><br><span class="line">        userMybatisMapper.update(userMybatis);</span><br><span class="line">        responseVO.success(<span class="string">&quot;å¯†ç ä¿®æ”¹æˆåŠŸï¼&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> responseVO;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** åˆ é™¤ç”¨æˆ· */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@Transactional(rollbackFor = Exception.class)</span></span><br><span class="line">    <span class="keyword">public</span> ResponseVO <span class="title function_">delete</span><span class="params">(DeleteDTO deleteDTO)</span> &#123;</span><br><span class="line">        <span class="type">ResponseVO</span> <span class="variable">responseVO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ResponseVO</span>();</span><br><span class="line">        <span class="type">Date</span> <span class="variable">date</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">        <span class="type">int</span> <span class="variable">deleteResult</span> <span class="operator">=</span> userMybatisMapper.updateStatusByUserId(deleteDTO.getUerId(),date);</span><br><span class="line">        <span class="keyword">if</span>(deleteResult != <span class="number">1</span>)&#123;</span><br><span class="line">            responseVO.fail(<span class="string">&quot;åˆ é™¤å¤±è´¥ï¼Œæ²¡æœ‰æ›´æ–°åˆ°æˆ–è€…æ›´æ–°äº†å¤šæ¡è®°å½•ï¼&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>  responseVO;</span><br><span class="line">        &#125;</span><br><span class="line">        responseVO.success(<span class="string">&quot;ç”¨æˆ·åˆ é™¤æˆåŠŸï¼&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> responseVO;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="æµ‹è¯•ç”¨ä¾‹"><a class="markdownIt-Anchor" href="#æµ‹è¯•ç”¨ä¾‹"></a> æµ‹è¯•ç”¨ä¾‹</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RunWith(SpringRunner.class)</span></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JavaSpringWingoApplicationTests</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource(name = &quot;userServiceMybatisImpl&quot;)</span></span><br><span class="line">    UserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** Md5Util è¾“å‡º */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testMd5</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(Md5Util.md5(<span class="string">&quot;e10adc3949ba59abbe56e057f20f883e&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** æµ‹è¯•æ³¨å†Œæ¥å£ */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@Rollback</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testRegister</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// æ„é€ æ³¨å†Œçš„æµ‹è¯•æ•°æ®</span></span><br><span class="line">        <span class="type">RegisterDTO</span> <span class="variable">registerDTO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RegisterDTO</span>();</span><br><span class="line">        registerDTO.setUsername(<span class="string">&quot;Jay&quot;</span>);</span><br><span class="line">        registerDTO.setPassword(<span class="string">&quot;123456&quot;</span>);</span><br><span class="line">        <span class="comment">// å¤„ç†ä¸šåŠ¡</span></span><br><span class="line">        <span class="type">ResponseVO</span> <span class="variable">responseVO</span> <span class="operator">=</span> userService.register(registerDTO);</span><br><span class="line">        <span class="comment">// æµ‹è¯•æ–­è¨€</span></span><br><span class="line">        assertEquals(ResponseConstant.SUCCESS, responseVO.get(<span class="string">&quot;code&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** æµ‹è¯•ç™»å½•æ¥å£ */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testLogin</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">LoginDTO</span> <span class="variable">loginDTO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">LoginDTO</span>();</span><br><span class="line">        loginDTO.setUsername(<span class="string">&quot;Tom&quot;</span>);</span><br><span class="line">        loginDTO.setPassword(<span class="string">&quot;123456&quot;</span>);</span><br><span class="line">        loginDTO.setType(<span class="number">0</span>);</span><br><span class="line">        <span class="type">ResponseVO</span> <span class="variable">responseVO</span> <span class="operator">=</span> userService.login(loginDTO);</span><br><span class="line">        assertEquals(ResponseConstant.SUCCESS, responseVO.get(<span class="string">&quot;code&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** æµ‹è¯•æ·»åŠ æ¥å£ */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@Rollback</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testAdd</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">AddDTO</span> <span class="variable">addDTO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AddDTO</span>();</span><br><span class="line">        addDTO.setUsername(<span class="string">&quot;Tim&quot;</span>);</span><br><span class="line">        addDTO.setPassword(<span class="string">&quot;123456&quot;</span>);</span><br><span class="line">        <span class="type">ResponseVO</span> <span class="variable">responseVO</span> <span class="operator">=</span> userService.add(addDTO);</span><br><span class="line">        assertEquals(ResponseConstant.SUCCESS, responseVO.get(<span class="string">&quot;code&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** æµ‹è¯•ç”¨æˆ·åˆ—è¡¨æ¥å£ */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testView</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">ResponseVO</span> <span class="variable">responseVO</span> <span class="operator">=</span> userService.view();</span><br><span class="line">        System.out.println(responseVO);</span><br><span class="line">        assertEquals(ResponseConstant.SUCCESS, responseVO.get(<span class="string">&quot;code&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** æµ‹è¯•ä¿®æ”¹å¯†ç æ¥å£*/</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@Rollback</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testModify</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">ModifyDTO</span> <span class="variable">modifyDTO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ModifyDTO</span>();</span><br><span class="line">        modifyDTO.setUsername(<span class="string">&quot;Jay&quot;</span>);</span><br><span class="line">        modifyDTO.setType(<span class="number">0</span>);</span><br><span class="line">        modifyDTO.setPassword(<span class="string">&quot;123456&quot;</span>);</span><br><span class="line">        modifyDTO.setNewPassword(<span class="string">&quot;654321&quot;</span>);</span><br><span class="line">        modifyDTO.setConfirmNewPassword(<span class="string">&quot;654321&quot;</span>);</span><br><span class="line">        <span class="type">ResponseVO</span> <span class="variable">responseVO</span> <span class="operator">=</span> userService.modify(modifyDTO);</span><br><span class="line">        assertEquals(ResponseConstant.SUCCESS, responseVO.get(<span class="string">&quot;code&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æ§åˆ¶å±‚"><a class="markdownIt-Anchor" href="#æ§åˆ¶å±‚"></a> æ§åˆ¶å±‚</h3>
<h4 id="swagger-æ•´åˆ"><a class="markdownIt-Anchor" href="#swagger-æ•´åˆ"></a> Swagger æ•´åˆ</h4>
<p>ç”¨äºæµè§ˆå™¨è¯·æ±‚æµ‹è¯•ã€‚</p>
<blockquote>
<p>ä¹Ÿå¯é‡‡ç”¨ Spring Boot æä¾›çš„ swagger çš„ staterï¼Œåˆ©ç”¨å¯åŠ¨å™¨çš„æ–¹å¼æ·»åŠ ä¾èµ–ï¼Œå¯ä»¥ç›´åœ¨ Spring Boot çš„é…ç½®æ–‡ä»¶ä¸­é…ç½® swagger çš„é…ç½®ä¿¡æ¯ã€‚</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- æ·»åŠ  Swagger çš„æ”¯æŒ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.springfox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springfox-swagger2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.springfox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springfox-swagger-ui<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>é…ç½®ç±»</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableSwagger2</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SwaggerConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Docket <span class="title function_">createRestApi</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Docket</span>(DocumentationType.SWAGGER_2).apiInfo(apiInfo())</span><br><span class="line">                .select()</span><br><span class="line">                .apis(RequestHandlerSelectors.basePackage(<span class="string">&quot;com.wingo.user.controller&quot;</span>))</span><br><span class="line">                .paths(PathSelectors.any()).build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ApiInfo <span class="title function_">apiInfo</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ApiInfoBuilder</span>().title(<span class="string">&quot;Swagger RESTful APIs&quot;</span>)</span><br><span class="line">                .description(<span class="string">&quot;Swagger API æœåŠ¡&quot;</span>)</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ä»£ç ç¼–å†™"><a class="markdownIt-Anchor" href="#ä»£ç ç¼–å†™"></a> ä»£ç ç¼–å†™</h4>
<blockquote>
<ul>
<li>Model modelï¼šSpring MVC æä¾›äº†ä¸€ä¸ª<code>Model</code>ç”¨äºæš´éœ²åç«¯ä¼ é€’ç»™é¡µé¢çš„ä¿¡æ¯ï¼Œé€šè¿‡<code>addAttribute(K, V)</code>æ–¹æ³•æ·»åŠ æ•°æ®ï¼Œå¹¶ä¸”åœ¨å‰ç«¯çš„æ¨¡æ¿å¼•æ“é¡µé¢é€šè¿‡<code>$&#123;K&#125;</code>å–å¾—å¯¹åº”çš„<code>V</code>ï¼›</li>
<li>HttpServletResponse httpServletResponseï¼š<code>encodeRedirectURL(Url)</code>æ–¹æ³•è¿›è¡Œé¡µé¢è·³è½¬ï¼Œè·³è½¬çš„åŒæ—¶æºå¸¦åŸŸä¸­çš„ä¿¡æ¯ï¼›</li>
<li>HttpSession httpSessionï¼š<code>setAttribute(K, V)</code>æ–¹æ³•åœ¨ Session åŸŸä¸­æ·»åŠ ä¿¡æ¯ã€‚</li>
</ul>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** æ³¨å…¥ UserService */</span></span><br><span class="line">    <span class="meta">@Resource(name = &quot;userServiceMybatisImpl&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** å¤„ç†ç”¨æˆ·æ³¨å†Œçš„è¯·æ±‚ */</span></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;ç”¨æˆ·æ³¨å†Œæ¥å£&quot;)</span></span><br><span class="line">    <span class="meta">@PostMapping(value = &quot;/register&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">register</span><span class="params">(Model model, <span class="meta">@Valid</span> <span class="meta">@ModelAttribute(value = &quot;registerDTO&quot;)</span> RegisterDTO registerDTO, HttpServletResponse httpServletResponse)</span> &#123;</span><br><span class="line">        <span class="type">ResponseVO</span> <span class="variable">responseVO</span> <span class="operator">=</span> userService.register(registerDTO);</span><br><span class="line">        model.addAttribute(ResponseConstant.RESPONSE_VO, responseVO);</span><br><span class="line">        <span class="keyword">if</span> (ResponseConstant.SUCCESS.equals(responseVO.get(ResponseConstant.CODE))) &#123;</span><br><span class="line">            <span class="comment">// æ³¨å†ŒæˆåŠŸï¼Œé‡å®šå‘åˆ°å‰ç«¯ç™»å½•é¡µé¢ login.htmlï¼Œå¹¶ä¸”æºå¸¦æ•°æ®è¿‡å»</span></span><br><span class="line">            <span class="keyword">return</span> httpServletResponse.encodeRedirectURL(UrlConstant.LOGIN);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ³¨å†Œå¤±è´¥ï¼Œè·³è½¬åˆ°æ³¨å†Œé¡µé¢ï¼Œå¹¶å°†å¤±è´¥çš„ä¿¡æ¯è¿”å›</span></span><br><span class="line">        <span class="keyword">return</span> httpServletResponse.encodeRedirectURL(UrlConstant.REGISTER);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”Ÿæˆå›¾å½¢éªŒè¯ç </span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> NoSuchAlgorithmException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ApiIgnore</span></span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;/imageCode&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">imageCode</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">        <span class="keyword">throws</span> IOException, NoSuchAlgorithmException &#123;</span><br><span class="line">        <span class="type">OutputStream</span> <span class="variable">os</span> <span class="operator">=</span> response.getOutputStream();</span><br><span class="line">        <span class="comment">// ç”ŸæˆéªŒè¯ç </span></span><br><span class="line">        Map&lt;String, Object&gt; map = ImageCodeUtil.getImageCode(<span class="number">60</span>, <span class="number">20</span>, <span class="number">4</span>);</span><br><span class="line">        <span class="comment">// æ”¾å…¥å®¢æˆ·ç«¯çš„ Session å¯¹è±¡ä¸­</span></span><br><span class="line">        request.getSession().setAttribute(ImageCodeConstant.SIMPLE_CAPTCHA,</span><br><span class="line">                                          map.get(ImageCodeConstant.CAPTCHA_VALUE).toString().toLowerCase());</span><br><span class="line">        <span class="comment">// è®¾ç½®éªŒè¯ç çš„ç”Ÿæˆæ—¶é—´ï¼Œå¹¶æ”¾å…¥å®¢æˆ·ç«¯ Session å¯¹è±¡ä¸­</span></span><br><span class="line">        request.getSession().setAttribute(ImageCodeConstant.CODE_TIME, System.currentTimeMillis());</span><br><span class="line">        <span class="comment">// å°†ç”Ÿæˆçš„éªŒè¯ç å›¾ç‰‡å†™åˆ°å›¾ç‰‡è¾“å‡ºæµ</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            ImageIO.write((BufferedImage) map.get(ImageCodeConstant.IMAGE), ImageCodeConstant.JPEG, os);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;å›¾å½¢éªŒè¯ç ç”Ÿæˆå¼‚å¸¸&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** å¤„ç†ç”¨æˆ·çš„ç™»å½•è¯·æ±‚ */</span></span><br><span class="line">    <span class="meta">@ApiIgnore</span></span><br><span class="line">    <span class="meta">@PostMapping(value = &quot;/login&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">login</span><span class="params">(Model model, <span class="meta">@Valid</span> <span class="meta">@ModelAttribute(value = &quot;loginDTO&quot;)</span> LoginDTO loginDTO,</span></span><br><span class="line"><span class="params">                        HttpServletResponse httpServletResponse, HttpSession httpSession)</span> &#123;</span><br><span class="line">        <span class="type">ResponseVO</span> <span class="variable">responseVO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ResponseVO</span>();</span><br><span class="line">        <span class="comment">// å–å¾—ç”¨æˆ·å¡«å†™çš„éªŒè¯ç </span></span><br><span class="line">        <span class="type">String</span> <span class="variable">checkCode</span> <span class="operator">=</span> loginDTO.getCheckCode();</span><br><span class="line">        <span class="comment">// ä» Session ä¸­å–å¾—å­˜å…¥çš„éªŒè¯ç ä¿¡æ¯</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">sessionImageCode</span> <span class="operator">=</span> httpSession.getAttribute(ImageCodeConstant.SIMPLE_CAPTCHA);</span><br><span class="line">        <span class="comment">// è·å–éªŒè¯ç ä¿¡æ¯å¤±è´¥</span></span><br><span class="line">        <span class="keyword">if</span>(sessionImageCode == <span class="literal">null</span>)&#123;</span><br><span class="line">            responseVO.fail(<span class="string">&quot;è¯·å¡«å†™éªŒè¯ç &quot;</span>);</span><br><span class="line">            model.addAttribute(ResponseConstant.RESPONSE_VO, responseVO);</span><br><span class="line">            <span class="keyword">return</span> httpServletResponse.encodeRedirectURL(UrlConstant.LOGIN);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">String</span> <span class="variable">code</span> <span class="operator">=</span> sessionImageCode.toString();</span><br><span class="line">        <span class="comment">// æ£€æµ‹éªŒè¯ç </span></span><br><span class="line">        <span class="type">Date</span> <span class="variable">date</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">        <span class="type">Long</span> <span class="variable">codeTime</span> <span class="operator">=</span> Long.valueOf(httpSession.getAttribute(ImageCodeConstant.CODE_TIME) + <span class="string">&quot;&quot;</span>);</span><br><span class="line">        <span class="comment">// éªŒè¯ç æ˜¯å¦å¡«å†™æ­£ç¡®</span></span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isBlank(checkCode) || StringUtils.isBlank(code) || !(checkCode.equalsIgnoreCase(code))) &#123;</span><br><span class="line">            responseVO.fail(<span class="string">&quot;éªŒè¯ç ä¸ä¸€è‡´&quot;</span>);</span><br><span class="line">            model.addAttribute(ResponseConstant.RESPONSE_VO, responseVO);</span><br><span class="line">            <span class="keyword">return</span> httpServletResponse.encodeRedirectURL(UrlConstant.LOGIN);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// éªŒè¯ç æ˜¯å¦è¿‡æœŸï¼ˆæœ‰æ•ˆæœŸä¸º 5 åˆ†é’Ÿï¼‰</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ((date.getTime() - codeTime) / ImageCodeConstant.MILLISECOND_CONVERSION</span><br><span class="line">                 / ImageCodeConstant.MINUTE_CONVERSION &gt; ImageCodeConstant.CAPTCHA_EXPIRY_TIME) &#123;</span><br><span class="line">            responseVO.fail(<span class="string">&quot;éªŒè¯ç å·²è¿‡æœŸ&quot;</span>);</span><br><span class="line">            model.addAttribute(ResponseConstant.RESPONSE_VO, responseVO);</span><br><span class="line">            <span class="keyword">return</span> httpServletResponse.encodeRedirectURL(UrlConstant.LOGIN);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å¤„ç†ç”¨æˆ·ç™»å½•ä¸šåŠ¡</span></span><br><span class="line">        responseVO = userService.login(loginDTO);</span><br><span class="line">        <span class="comment">// å°†ç»“æœæ”¾å…¥ model ä¸­ï¼Œåœ¨æ¨¡æ¿ä¸­å¯ä»¥å–åˆ° model ä¸­çš„å€¼</span></span><br><span class="line">        <span class="comment">// è¿™é‡Œå°±æ˜¯äº¤äº’çš„ä¸€ä¸ªé‡è¦åœ°æ–¹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ¨¡æ¿ä¸­é€šè¿‡è¿™äº›å±æ€§å€¼è®¿é—®åˆ°æ•°æ®</span></span><br><span class="line">        model.addAttribute(ResponseConstant.RESPONSE_VO, responseVO);</span><br><span class="line">        <span class="comment">// è®¾ç½®ç™»å½• sessionï¼Œæ¨¡ç‰ˆå¼•æ“ä½¿ç”¨</span></span><br><span class="line">        httpSession.setAttribute(UserConstant.USERNAME, loginDTO.getUsername());</span><br><span class="line">        httpSession.setAttribute(UserConstant.TYPE, loginDTO.getType());</span><br><span class="line">        <span class="comment">// å°†ç±»å‹ç è½¬æ¢ä¸ºä¸­æ–‡è¯´æ˜</span></span><br><span class="line">        httpSession.setAttribute(UserConstant.TYPE_NAME, UserTypeConstant.typeToDesc(loginDTO.getType()));</span><br><span class="line">        <span class="comment">// ç»„è£…ç»“æœè¿”å›</span></span><br><span class="line">        <span class="keyword">if</span> (responseVO == <span class="literal">null</span> || !ResponseConstant.SUCCESS.equals(responseVO.get(ResponseConstant.CODE))) &#123;</span><br><span class="line">            <span class="comment">// ç™»å½•å¤±è´¥åˆ™è·³è½¬åˆ°å‰ç«¯ç™»å½•é¡µé¢ login.html</span></span><br><span class="line">            <span class="keyword">return</span> httpServletResponse.encodeRedirectURL(UrlConstant.LOGIN);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ç™»å½•æˆåŠŸé‡å®šå‘åˆ°å‰ç«¯é¦–é¡µ index.htmlï¼Œå¹¶ä¸”æºå¸¦æ•°æ®è¿‡å»</span></span><br><span class="line">        <span class="keyword">return</span> httpServletResponse.encodeRedirectURL(UrlConstant.INDEX);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** å¤„ç†æŸ¥çœ‹ç”¨æˆ·åˆ—è¡¨çš„è¯·æ±‚ */</span></span><br><span class="line">    <span class="meta">@ApiIgnore</span></span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;/users&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">users</span><span class="params">(Model model, HttpServletResponse httpServletResponse)</span> &#123;</span><br><span class="line">        <span class="comment">// å¤„ç†ç”¨æˆ·åˆ—è¡¨æŸ¥çœ‹ä¸šåŠ¡</span></span><br><span class="line">        <span class="type">ResponseVO</span> <span class="variable">responseVO</span> <span class="operator">=</span> userService.view();</span><br><span class="line">        model.addAttribute(ResponseConstant.RESPONSE_VO, responseVO);</span><br><span class="line">        <span class="comment">// å¼€å§‹é‡å®šå‘å‰ç«¯ç”¨æˆ·åˆ—è¡¨ä¹Ÿ view.htmlï¼Œæºå¸¦æ•°æ®è¿‡å»äº†ã€‚</span></span><br><span class="line">        <span class="keyword">return</span> httpServletResponse.encodeRedirectURL(UrlConstant.VIEW);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** å¤„ç†æ–°å¢ç”¨æˆ·çš„è¯·æ±‚ */</span></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;ç”¨æˆ·æ–°å¢æ¥å£&quot;)</span></span><br><span class="line">    <span class="meta">@PostMapping(value = &quot;/user&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">user</span><span class="params">(Model model, <span class="meta">@Valid</span> <span class="meta">@ModelAttribute(value = &quot;addDTO&quot;)</span> AddDTO addDTO,</span></span><br><span class="line"><span class="params">                       HttpServletResponse httpServletResponse)</span> &#123;</span><br><span class="line">        <span class="comment">// å¤„ç†æ–°å¢ç”¨æˆ·ä¸šåŠ¡</span></span><br><span class="line">        <span class="type">ResponseVO</span> <span class="variable">responseVO</span> <span class="operator">=</span> userService.add(addDTO);</span><br><span class="line">        <span class="comment">// å°†å¤„ç†ç»“æœå†™å…¥åˆ°è¿”å›å¯¹è±¡ä¸­</span></span><br><span class="line">        model.addAttribute(ResponseConstant.RESPONSE_VO, responseVO);</span><br><span class="line">        <span class="comment">// ç”¨æˆ·æ·»åŠ å¤±è´¥ï¼Œé‡å®šå‘åˆ°å‰ç«¯é¡µé¢ user.html</span></span><br><span class="line">        <span class="keyword">if</span> (responseVO == <span class="literal">null</span> || !ResponseConstant.SUCCESS.equals(responseVO.get(ResponseConstant.CODE)))&#123;</span><br><span class="line">            <span class="keyword">return</span> httpServletResponse.encodeRedirectURL(UrlConstant.USER);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å¤„ç†æˆåŠŸ</span></span><br><span class="line">        responseVO = userService.view();</span><br><span class="line">        model.addAttribute(ResponseConstant.RESPONSE_VO, responseVO);</span><br><span class="line">        <span class="comment">// å¼€å§‹é‡å®šå‘ï¼Œæºå¸¦æ•°æ®è¿‡å»</span></span><br><span class="line">        <span class="keyword">return</span> httpServletResponse.encodeRedirectURL(UrlConstant.VIEW);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** åˆ é™¤ç”¨æˆ· */</span></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;åˆ é™¤ç”¨æˆ·æ¥å£&quot;)</span></span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;/delete&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">delete</span><span class="params">(Model model, <span class="meta">@Valid</span> <span class="meta">@ModelAttribute(value = &quot;deleteDTO&quot;)</span> DeleteDTO deleteDTO,</span></span><br><span class="line"><span class="params">                         HttpServletResponse httpServletResponse)</span> &#123;</span><br><span class="line">        <span class="comment">// å¤„ç†é€»è¾‘åˆ é™¤ç”¨æˆ·ä¸šåŠ¡</span></span><br><span class="line">        <span class="type">ResponseVO</span> <span class="variable">responseVO</span> <span class="operator">=</span> userService.delete(deleteDTO);</span><br><span class="line">        <span class="comment">// åˆ é™¤å¤±è´¥è¿”å›é”™è¯¯ä¿¡æ¯</span></span><br><span class="line">        <span class="keyword">if</span>(responseVO.get(ResponseConstant.CODE).equals(ResponseConstant.FAIL))&#123;</span><br><span class="line">            model.addAttribute(ResponseConstant.RESPONSE_VO, responseVO);</span><br><span class="line">            <span class="keyword">return</span> httpServletResponse.encodeRedirectURL(UrlConstant.VIEW);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// åˆ é™¤æˆåŠŸåå†æŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨æ•°æ®ï¼Œè¿”å›åˆ é™¤åçš„æœ€æ–°ç”¨æˆ·åˆ—è¡¨æ•°æ®</span></span><br><span class="line">        responseVO = userService.view();</span><br><span class="line">        <span class="keyword">if</span> (responseVO != <span class="literal">null</span>) &#123;</span><br><span class="line">            model.addAttribute(ResponseConstant.RESPONSE_VO, responseVO);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// é€»è¾‘åˆ é™¤ç”¨æˆ·åï¼Œè·³è½¬åˆ°ç”¨æˆ·å‰ç«¯åˆ—è¡¨é¡µ view.jsp</span></span><br><span class="line">        <span class="keyword">return</span> httpServletResponse.encodeRedirectURL(UrlConstant.VIEW);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** å¤„ç†ç”¨æˆ·ä¿¡æ¯ä¿®æ”¹çš„è¯·æ±‚ */</span></span><br><span class="line">    <span class="meta">@ApiIgnore</span></span><br><span class="line">    <span class="meta">@PostMapping(value = &quot;/modify&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toModify</span><span class="params">(Model model, <span class="meta">@Valid</span> <span class="meta">@ModelAttribute(value = &quot;modifyDTO&quot;)</span> ModifyDTO modifyDTO,</span></span><br><span class="line"><span class="params">                           HttpServletResponse httpServletResponse, HttpSession httpSession)</span> &#123;</span><br><span class="line">        <span class="comment">// ä» Session ä¸­å–å¾—ç”¨æˆ·åå­—åŠç±»å‹</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">strUsername</span> <span class="operator">=</span> httpSession.getAttribute(UserConstant.USERNAME).toString();</span><br><span class="line">        <span class="type">String</span> <span class="variable">strType</span> <span class="operator">=</span> httpSession.getAttribute(UserConstant.TYPE).toString();</span><br><span class="line">        modifyDTO.setUsername(strUsername);</span><br><span class="line">        modifyDTO.setType(strType);</span><br><span class="line">        <span class="comment">// å¤„ç†ç”¨æˆ·ä¿¡æ¯ä¿®æ”¹ä¸šåŠ¡</span></span><br><span class="line">        <span class="type">ResponseVO</span> <span class="variable">responseVO</span> <span class="operator">=</span> userService.modify(modifyDTO);</span><br><span class="line">        <span class="comment">// å°†ç»“æœæ”¾å…¥ Model ä¸­ï¼Œåœ¨æ¨¡æ¿ä¸­å¯ä»¥å–åˆ° Model ä¸­çš„å€¼</span></span><br><span class="line">        model.addAttribute(ResponseConstant.RESPONSE_VO, responseVO);</span><br><span class="line">        <span class="keyword">if</span> (responseVO == <span class="literal">null</span> || !ResponseConstant.SUCCESS.equals(responseVO.get(ResponseConstant.CODE))) &#123;</span><br><span class="line">            <span class="comment">// ä¿®æ”¹å¤±è´¥æ—¶ï¼Œç»§ç»­é‡å®šå‘åˆ°å‰ç«¯ç”¨æˆ·ä¿¡æ¯ä¿®æ”¹é¡µé¢ modify.html</span></span><br><span class="line">            <span class="keyword">return</span> httpServletResponse.encodeRedirectURL(UrlConstant.MODIFY);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å¯†ç ä¿®æ”¹æˆåŠŸï¼Œä» Session ä¸­åˆ é™¤ user å±æ€§ï¼Œç”¨æˆ·é€€å‡ºç™»å½•</span></span><br><span class="line">        httpSession.removeAttribute(UserConstant.USERNAME);</span><br><span class="line">        httpSession.removeAttribute(UserConstant.TYPE);</span><br><span class="line">        httpSession.removeAttribute(UserConstant.TYPE_NAME);</span><br><span class="line">        <span class="comment">// å¼€å§‹é‡å®šå‘å‰ç«¯ç™»å½•é¡µé¢ login.htmlï¼Œå¹¶ä¸”æºå¸¦æ•°æ®è¿‡å»</span></span><br><span class="line">        <span class="keyword">return</span> httpServletResponse.encodeRedirectURL(UrlConstant.LOGIN);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** æ³¨é”€ç™»å½• */</span></span><br><span class="line">    <span class="meta">@ApiIgnore</span></span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;/loginOut&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">loginOut</span><span class="params">(HttpSession httpSession, HttpServletResponse httpServletResponse)</span> &#123;</span><br><span class="line">        <span class="comment">// ä» Session ä¸­åˆ é™¤ user å±æ€§ï¼Œç”¨æˆ·é€€å‡ºç™»å½•</span></span><br><span class="line">        httpSession.removeAttribute(UserConstant.USERNAME);</span><br><span class="line">        httpSession.removeAttribute(UserConstant.TYPE);</span><br><span class="line">        httpSession.removeAttribute(UserConstant.TYPE_NAME);</span><br><span class="line">        <span class="comment">// å¼€å§‹é‡å®šå‘åˆ°å‰ç«¯é¡µé¢ login.html</span></span><br><span class="line">        <span class="keyword">return</span> httpServletResponse.encodeRedirectURL(UrlConstant.LOGIN);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/** å¤„ç† Get:/index è¯·æ±‚ */</span></span><br><span class="line">    <span class="meta">@ApiIgnore</span></span><br><span class="line">    <span class="meta">@GetMapping(value=&quot;/index&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">index</span><span class="params">(HttpServletResponse httpServletResponse)</span>&#123;</span><br><span class="line">        <span class="comment">// é‡å®šå‘åˆ°å‰ç«¯é¡µé¢ index.html</span></span><br><span class="line">        <span class="keyword">return</span> httpServletResponse.encodeRedirectURL(UrlConstant.INDEX);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// çœç•¥ä½™ä¸‹é¡µé¢è·³æ–¹æ³•</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="thymeleaf"><a class="markdownIt-Anchor" href="#thymeleaf"></a> Thymeleaf</h3>
<p>å¼•å…¥ä¾èµ–ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- æ”¯æŒ Thymeleaf --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-thymeleaf<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>é…ç½® Thymeleafï¼š</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## Thymeleaf é…ç½®</span></span><br><span class="line"><span class="attr">spring.thymeleaf.prefix</span>=<span class="string">classpath:/templates</span></span><br><span class="line"><span class="attr">spring.thymeleaf.suffix</span>=<span class="string">.html</span></span><br><span class="line"><span class="attr">spring.thymeleaf.mode</span>=<span class="string">HTML</span></span><br><span class="line"><span class="attr">spring.thymeleaf.servlet.content-type</span>=<span class="string">text/html</span></span><br><span class="line"><span class="attr">spring.thymeleaf.cache</span>=<span class="string">false</span></span><br><span class="line"><span class="attr">spring.thymeleaf.enabled</span>=<span class="string">true</span></span><br></pre></td></tr></table></figure>
<h4 id="loginhtml"><a class="markdownIt-Anchor" href="#loginhtml"></a> login.html</h4>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html; charset=UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>ç™»å½•<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:if</span>=<span class="string">&quot;$&#123;responseVO != null &amp;&amp; responseVO.get(&#x27;message&#x27;) != null&#125;&quot;</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;responseVO.get(&#x27;message&#x27;)&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/login&#125;&quot;</span> <span class="attr">th:object</span>=<span class="string">&quot;$&#123;loginDTO&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;height: 27px&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;username&quot;</span>&gt;</span>ç”¨æˆ·å: <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">id</span>=<span class="string">&quot;username&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;ç”¨æˆ·å&quot;</span></span></span><br><span class="line"><span class="tag">                       <span class="attr">th:value</span>=<span class="string">&quot;$&#123;registerDTO !=null &amp;&amp; registerDTO.username != null&#125; ? $&#123;registerDTO.username&#125; : &#x27;&#x27;&quot;</span></span></span><br><span class="line"><span class="tag">                       /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;height: 27px&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;password&quot;</span>&gt;</span>å¯†ç : <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">id</span>=<span class="string">&quot;password&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;å¯†ç &quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;height: 27px&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;checkCode&quot;</span> <span class="attr">class</span>=<span class="string">&quot;green&quot;</span>&gt;</span>éªŒè¯ç : <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;checkCode&quot;</span> <span class="attr">name</span>=<span class="string">&quot;checkCode&quot;</span> <span class="attr">class</span>=<span class="string">&quot;checkCode&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;éªŒè¯ç &quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">img</span> <span class="attr">style</span>=<span class="string">&quot;cursor: pointer; margin-left: 3px;&quot;</span> <span class="attr">th:src</span>=<span class="string">&quot;@&#123;/imageCode&#125;&quot;</span></span></span><br><span class="line"><span class="tag">                     <span class="attr">onclick</span>=<span class="string">&quot;this.src=this.src + &#x27;?&#x27; + new Date().valueOf();&quot;</span> <span class="attr">id</span>=<span class="string">&quot;validateImg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;éªŒè¯ç &quot;</span> <span class="attr">class</span>=<span class="string">&quot;codePic&quot;</span></span></span><br><span class="line"><span class="tag">                     <span class="attr">title</span>=<span class="string">&quot;éªŒè¯ç ã€‚ç‚¹å‡»æ­¤å¤„æ›´æ–°éªŒè¯ç ã€‚&quot;</span></span></span><br><span class="line"><span class="tag">       			/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;height: 27px&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;type&quot;</span>&gt;</span>ç”¨æˆ·ç±»å‹: <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;type&quot;</span> <span class="attr">name</span>=<span class="string">&quot;type&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">option</span> <span class="attr">type</span>=<span class="string">&quot;number&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0&quot;</span> &gt;</span>æ™®é€šç”¨æˆ·<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">option</span> <span class="attr">type</span>=<span class="string">&quot;number&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span> &gt;</span>ç®¡ç†å‘˜ç”¨æˆ·<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;ç™»å½•&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="indexhtml"><a class="markdownIt-Anchor" href="#indexhtml"></a> index.html</h4>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>ç™»å½•åçš„é¦–é¡µ<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h4</span>&gt;</span></span><br><span class="line">        æ¬¢è¿æ‚¨ï¼š<span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&quot;color: red&quot;</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;session.username&#125;?$&#123;session.username&#125;:&#x27;ï¼ˆæ‚¨æœªç™»å½•ï¼‰&#x27;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>, ç”¨æˆ·èº«ä»½æ˜¯ï¼š<span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">            <span class="attr">style</span>=<span class="string">&quot;color: red&quot;</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;session.typeName&#125;?$&#123;session.typeName&#125;:&#x27;ï¼ˆæ‚¨æœªç™»å½•ï¼‰&#x27;&quot;</span></span></span><br><span class="line"><span class="tag">        &gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">th:block</span> <span class="attr">th:if</span>=<span class="string">&quot;$&#123;session.username != null&#125;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/users&#125;&quot;</span> <span class="attr">th:if</span>=<span class="string">&quot;$&#123;session.typeName eq &#x27;ç®¡ç†å‘˜&#x27;&#125;&quot;</span>&gt;</span>æŸ¥çœ‹ç”¨æˆ·åˆ—è¡¨<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/user&#125;&quot;</span> <span class="attr">th:if</span>=<span class="string">&quot;$&#123;session.typeName eq &#x27;ç®¡ç†å‘˜&#x27;&#125; &quot;</span>&gt;</span>æ·»åŠ ç”¨æˆ·<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/modify&#125;&quot;</span>&gt;</span>ä¿®æ”¹å¯†ç <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/loginOut&#125;&quot;</span>&gt;</span>æ³¨é”€ç™»å½•<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">th:block</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="modifyhtml"><a class="markdownIt-Anchor" href="#modifyhtml"></a> modify.html</h4>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>ä¿®æ”¹å¯†ç <span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:if</span>=<span class="string">&quot;$&#123;responseVO != null &amp;&amp; responseVO.get(&#x27;message&#x27;) != null&#125;&quot;</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;responseVO.get(&#x27;message&#x27;)&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">th:block</span> <span class="attr">th:if</span>=<span class="string">&quot;$&#123;session.username != null&#125;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/modify&#125;&quot;</span> <span class="attr">th:object</span>=<span class="string">&quot;$&#123;modifyDTO&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;password&quot;</span>&gt;</span>åŸå¯†ç :<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">id</span>=<span class="string">&quot;password&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;newPassword&quot;</span>&gt;</span>æ–°å¯†ç :<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;newPassword&quot;</span> <span class="attr">id</span>=<span class="string">&quot;newPassword&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;confirmNewPassword&quot;</span>&gt;</span>ç¡®è®¤æ–°å¯†ç :<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;confirmNewPassword&quot;</span> <span class="attr">id</span>=<span class="string">&quot;confirmNewPassword&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;ç¡®è®¤ä¿®æ”¹&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">th:block</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="registerhtml"><a class="markdownIt-Anchor" href="#registerhtml"></a> register.html</h4>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>ç”¨æˆ·æ³¨å†Œ<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:if</span>=<span class="string">&quot;$&#123;responseVO != null &amp;&amp; responseVO.get(&#x27;message&#x27;) != null&#125;&quot;</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;responseVO.get(&#x27;message&#x27;)&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/register&#125;&quot;</span> <span class="attr">th:object</span>=<span class="string">&quot;$&#123;registerDTO&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;username&quot;</span>&gt;</span>ç”¨æˆ·å:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">id</span>=<span class="string">&quot;username&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;password&quot;</span>&gt;</span>å¯†ç :<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">id</span>=<span class="string">&quot;password&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;æ³¨å†Œ&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="userhtml"><a class="markdownIt-Anchor" href="#userhtml"></a> user.html</h4>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>æ·»åŠ ç”¨æˆ·<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:if</span>=<span class="string">&quot;$&#123;responseVO != null &amp;&amp; responseVO.get(&#x27;message&#x27;) != null&#125;&quot;</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;responseVO.get(&#x27;message&#x27;)&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">th:block</span> <span class="attr">th:if</span>=<span class="string">&quot;$&#123;session.username != null &amp;&amp; session.typeName == &#x27;ç®¡ç†å‘˜&#x27;&#125;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/user&#125;&quot;</span> <span class="attr">th:object</span>=<span class="string">&quot;$&#123;addDTO&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;username&quot;</span>&gt;</span>ç”¨æˆ·å:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">id</span>=<span class="string">&quot;username&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;password&quot;</span>&gt;</span>å¯†ç :<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">id</span>=<span class="string">&quot;password&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;æ·»åŠ &quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">th:block</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="viewhtml"><a class="markdownIt-Anchor" href="#viewhtml"></a> view.html</h4>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>æŸ¥çœ‹ç”¨æˆ·åˆ—è¡¨<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>ID<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>åå­—<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>ç”¨æˆ·ç±»å‹<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>æ³¨å†Œæ—¶é—´<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>æ“ä½œç±»å‹<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th:block</span> <span class="attr">th:if</span>=<span class="string">&quot;$&#123;session.username != null &amp;&amp; session.typeName == &#x27;ç®¡ç†å‘˜&#x27;&#125;&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- å¾ªç¯å±•ç¤ºæ™®é€šç”¨æˆ·æ¸…å• --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th:block</span> <span class="attr">th:if</span>=<span class="string">&quot;$&#123;responseVO.get(&#x27;data&#x27;).viewVO != null&#125;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">tr</span> <span class="attr">th:each</span>=<span class="string">&quot;ViewVO : $&#123;responseVO.get(&#x27;data&#x27;).viewVO&#125;&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;ViewVO.userId&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;ViewVO.username&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;ViewVO.type&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;#dates.format(ViewVO.gmtCreate, &#x27;yyyy-MM-dd&#x27;)&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/delete(uerId=$&#123;ViewVO.userId&#125;)&#125;&quot;</span>&gt;</span>åˆ é™¤<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">th:block</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">th:block</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="è¿‡æ»¤å™¨"><a class="markdownIt-Anchor" href="#è¿‡æ»¤å™¨"></a> è¿‡æ»¤å™¨</h3>
<p>å¯¹æŸäº›ç‰¹å®šé¡µé¢çš„è®¿é—®éœ€è¦æœ‰ä¸€å®šçš„å‰ææ¡ä»¶ï¼šæ¯”å¦‚ç”¨æˆ·æ˜¯å¦ç™»å½•ï¼Œç”¨æˆ·æ˜¯å¦æ‹¥æœ‰è®¿é—®æ­¤é¡µé¢çš„æƒé™ç­‰ã€‚è¦å®ç°è¿™æ ·çš„åŠŸèƒ½å¯ä»¥ä½¿ç”¨ Filterã€‚</p>
<blockquote>
<p>è¿‡æ»¤å™¨æ‰§è¡Œé¡ºåºï¼š<br />
(1) é€šè¿‡å®ä¾‹åŒ– FilterRegistrationBean ç±»è‡ªå®šä¹‰ Filterï¼ŒsetOrder() æ–¹æ³•å¯ä»¥å®šä¹‰æ‰§è¡Œé¡ºåºã€‚ï¼ˆå°çš„ä¼˜å…ˆï¼‰<br />
(2) é€šè¿‡é™å®šç±»åé™å®š Filter çš„é¡ºåºã€‚ï¼ˆé»˜è®¤åˆå§‹åŒ–è¿‡æ»¤å™¨æ—¶è¿›è¡Œäº†ç±»åçš„æ’åºï¼‰</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@WebFilter(filterName = &quot;/Filter0Session&quot;, </span></span><br><span class="line"><span class="meta">           urlPatterns = &#123;&quot;/index&quot;, &quot;/add&quot;, &quot;/modify&quot;, &quot;/view&quot;, &quot;/delete&quot;, &quot;/loginOut&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Filter0Session</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Filter0Session</span><span class="params">()</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** è¿‡æ»¤å™¨åˆå§‹åŒ–æ–¹æ³•ï¼Œweb æœåŠ¡å™¨æ ¹æ®é…ç½®åˆ›å»º Filter å®ä¾‹ */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(FilterConfig fConfig)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">        <span class="comment">// Do nothing.</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span></span><br><span class="line">        <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">        <span class="type">HttpServletRequest</span> <span class="variable">httpServletRequest</span> <span class="operator">=</span> (HttpServletRequest) request;</span><br><span class="line">        <span class="type">HttpServletResponse</span> <span class="variable">httpServletResponse</span> <span class="operator">=</span> (HttpServletResponse) response;</span><br><span class="line">        <span class="type">HttpSession</span> <span class="variable">httpSession</span> <span class="operator">=</span> httpServletRequest.getSession(<span class="literal">false</span>);</span><br><span class="line">        <span class="keyword">if</span> (httpSession != <span class="literal">null</span> &amp;&amp; httpSession.getAttribute(UserConstant.USERNAME) != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="comment">// ç”¨æˆ·å·²ç™»å½•åˆ™æ”¾è¡Œ</span></span><br><span class="line">            chain.doFilter(request, response);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// æ£€æµ‹åˆ°ç”¨æˆ·æœªç™»å½•åˆ™è·³è½¬é‡å®šå‘åˆ°ç™»é™†é¡µé¢</span></span><br><span class="line">            httpServletResponse.sendRedirect(<span class="string">&quot;/login&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">/** è¿‡æ»¤å™¨é”€æ¯æ–¹æ³•ï¼Œå¯ä»¥é‡Šæ”¾è¿‡æ»¤å™¨ä½¿ç”¨çš„èµ„æº */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// Do nothing.</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@WebFilter(filterName = &quot;/Filter1Admin&quot;, urlPatterns = &#123;&quot;/add&quot;, &quot;/view&quot;, &quot;/delete&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Filter1Admin</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Filter1Admin</span><span class="params">()</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(FilterConfig fConfig)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">        <span class="comment">// Do nothing.</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span></span><br><span class="line">        <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">        <span class="type">HttpServletRequest</span> <span class="variable">httpServletRequest</span> <span class="operator">=</span> (HttpServletRequest) request;</span><br><span class="line">        <span class="type">HttpServletResponse</span> <span class="variable">httpServletResponse</span> <span class="operator">=</span> (HttpServletResponse) response;</span><br><span class="line">        <span class="type">HttpSession</span> <span class="variable">httpSession</span> <span class="operator">=</span> httpServletRequest.getSession(<span class="literal">false</span>);</span><br><span class="line">        <span class="comment">// æ£€æµ‹ç”¨æˆ·æ˜¯å¦ç™»å½•ï¼Œå¹¶ä¸”ç”¨æˆ·ç±»å‹æ˜¯å¦ä¸ºç®¡ç†å‘˜</span></span><br><span class="line">        <span class="keyword">if</span> (httpSession != <span class="literal">null</span> &amp;&amp; httpSession.getAttribute(UserConstant.USERNAME) != <span class="literal">null</span></span><br><span class="line">            &amp;&amp; httpSession.getAttribute(UserConstant.TYPE) != <span class="literal">null</span></span><br><span class="line">            &amp;&amp; UserTypeConstant.ADMIN.equals(httpSession.getAttribute(UserConstant.TYPE))) &#123;</span><br><span class="line">            chain.doFilter(request, response);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            httpServletResponse.sendRedirect( <span class="string">&quot;/login&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// Do nothing.</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ï¼ï¼ï¼@ServletComponentScan(value = â€œcom.wingo.user.filterâ€)</p>
</blockquote>
<h3 id="å…¨å±€å¼‚å¸¸å¤„ç†"><a class="markdownIt-Anchor" href="#å…¨å±€å¼‚å¸¸å¤„ç†"></a> å…¨å±€å¼‚å¸¸å¤„ç†</h3>
<p>å¯¹äºå‰ç«¯ä¼ è¾“çš„æ•°æ®ï¼Œåœ¨ DTO ç±»ä¸­æ·»åŠ  JSR303 æ ¡éªŒï¼Œåœ¨æµ‹è¯•çš„æ—¶å€™å‘ç°æ­¤æ ¡éªŒçš„æŠ›å‡ºå¼‚å¸¸æ—¶ï¼ŒSpring Boot ä¼šè‡ªåŠ¨è·³è½¬åˆ°é»˜è®¤çš„ error é¡µé¢ã€‚åŸå› åœ¨äºé¡¹ç›®ä¸­æœªå¯¹æ­¤æ ¡éªŒç´¢æŠ›å‡ºçš„å¼‚å¸¸è¿›è¡Œå¤„ç†ã€‚å…ˆçœ‹çœ‹æ ¡éªŒåæ‰€æŠ›å‡ºçš„å¼‚å¸¸ä¿¡æ¯ã€‚</p>
<p>Spring Boot é»˜è®¤çš„é”™è¯¯æç¤ºé¡µé¢ï¼š</p>
<p><img src="/img/2020/03/UserManagementSystem/ValidError01.png" alt="" /></p>
<p>æ§åˆ¶å°æŠ›å‡ºçš„å¼‚å¸¸<code>BindException: org.springframework.validation.BeanPropertyBindingResult: 3 errors</code></p>
<blockquote>
<p>å¯ä»¥åœ¨ controller ç±»ä¸­æ·»åŠ  try{ }catch{ } å¼‚å¸¸å¤„ç†å—æ•æ‰å¼‚å¸¸æŠ›å‡ºï¼Œå¹¶è¿›è¡Œå¤„ç†ï¼ˆå¦‚è¿”å› Jsonï¼‰ã€‚ä½†è¿™æ ·ä»£ç å¾ˆä¸ç¾è§‚ï¼Œæ¨èä½¿ç”¨çš„æ–¹å¼æ˜¯ç”¨æ³¨è§£ @ControllerAdvice + @ExceptionHandler å…¨å±€å¤„ç† Controller å±‚å¼‚å¸¸ã€‚</p>
</blockquote>
<p>ç¼–å†™å…¨å±€å¤„ç†ç±»</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@ControllerAdvice</span> <span class="comment">// å£°æ˜å…¨å±€çš„å¼‚å¸¸å¤„ç†ç±»</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GlobalExceptionHandler</span> &#123;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">// å®šä¹‰æ•æ‰çš„å¼‚å¸¸</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(BindException.class)</span></span><br><span class="line">    <span class="meta">@ResponseStatus(HttpStatus.BAD_REQUEST)</span></span><br><span class="line">    <span class="keyword">public</span> ResponseVO <span class="title function_">resolveMethodArgumentNotValidException</span><span class="params">(BindException exception)</span> &#123;</span><br><span class="line">        <span class="type">ResponseVO</span> <span class="variable">response</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ResponseVO</span>();</span><br><span class="line">        <span class="comment">// å®šä¹‰å­—æ®µåŠæ ¡éªŒå¼‚å¸¸ä¿¡æ¯çš„ key / value ç»“æ„</span></span><br><span class="line">        Map&lt;String, String&gt; fieldAndMessage = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(<span class="number">16</span>);</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="comment">// ç»„è£…å­—æ®µåŠæ ¡éªŒå¼‚å¸¸ä¿¡æ¯</span></span><br><span class="line">        <span class="keyword">for</span> (FieldError fieldError : exception.getBindingResult().getFieldErrors()) &#123;</span><br><span class="line">            fieldAndMessage.put(fieldError.getField(), fieldError.getDefaultMessage());</span><br><span class="line">            sb.append(fieldError.getField()).append(<span class="string">&quot;:&quot;</span>).append(fieldError.getDefaultMessage()).append(<span class="string">&quot;;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">String</span> <span class="variable">strField</span> <span class="operator">=</span> sb.toString();</span><br><span class="line">        <span class="comment">// ç»„è£…å¼‚å¸¸ä¿¡æ¯ï¼šä»è‡ªå®šä¹‰çš„å¼‚å¸¸ä¿¡æ¯æšä¸¾ç±»ä¸­å–å¾—ä¿¡æ¯</span></span><br><span class="line">        response.setCode(ResponseCodeTypeEnum.PARAMETER_ERROR.getCode());</span><br><span class="line">        response.setMessage(ResponseCodeTypeEnum.PARAMETER_ERROR.getMessage());</span><br><span class="line">        <span class="comment">// æ–¹ä¾¿è°ƒè¯•ï¼šå°†å¼‚å¸¸ç»Ÿä¸€æ‰“å°å‡ºæ¥</span></span><br><span class="line">        log.warn(<span class="string">&quot;BindException.class å¼‚å¸¸ä¿¡æ¯: &#123;&#125;&quot;</span>, strField);</span><br><span class="line">        <span class="comment">// è¿”å› Json</span></span><br><span class="line">        <span class="keyword">return</span> response;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œç»“æœï¼šæ­¤æ—¶å·²ä¸æ˜¾ç¤ºé»˜è®¤çš„é”™è¯¯é¡µé¢ï¼Œè€Œæ˜¯æ˜¾ç¤ºç”±ç”¨æˆ·å®šä¹‰çš„ Json å­—ç¬¦ä¸²ã€‚</p>
<p><img src="/img/2020/03/UserManagementSystem/ValidError02.png" alt="" /></p>
<p>æ§åˆ¶å°è¾“å‡ºï¼šæ–¹ä¾¿å¼€å‘è°ƒè¯•ã€‚</p>
<p><img src="/img/2020/03/UserManagementSystem/ValidError03.png" alt="" /></p>
<h3 id="è‡ªå®šä¹‰-sql-æ—¥å¿—æ‰“å°"><a class="markdownIt-Anchor" href="#è‡ªå®šä¹‰-sql-æ—¥å¿—æ‰“å°"></a> è‡ªå®šä¹‰ SQL æ—¥å¿—æ‰“å°</h3>
<p>å½“å¼€å¯ Mybatis çš„é»˜è®¤æ—¥å¿—æ‰“å°ï¼Œæ§åˆ¶å°çš„ SQL é»˜è®¤æ‰“å°æ ·å¼ï¼š</p>
<p><img src="/img/2020/03/UserManagementSystem/SQLLog01.png" alt="" /></p>
<p>è‡ªå®šä¹‰æ‹¦æˆªå™¨ï¼š</p>
<p>[Mybatis æ’ä»¶æ‹¦æˆªå™¨]([<a target="_blank" rel="noopener" href="https://welab-wingo.cn/2020/03/29/Software/Mybatis/Mybatis%20%E6%8F%92%E4%BB%B6%E4%B9%8B%E6%8B%A6%E6%88%AA%E5%99%A8/">https://welab-wingo.cn/2020/03/29/Software/Mybatis/Mybatis æ’ä»¶ä¹‹æ‹¦æˆªå™¨/</a>](<a target="_blank" rel="noopener" href="https://welab-wingo.cn/2020/03/29/Software/Mybatis/Mybatis">https://welab-wingo.cn/2020/03/29/Software/Mybatis/Mybatis</a> æ’ä»¶ä¹‹æ‹¦æˆªå™¨/))</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Intercepts(&#123;@Signature(type = Executor.class, method = &quot;update&quot;, </span></span><br><span class="line"><span class="meta">                        args = &#123;MappedStatement.class, Object.class&#125;),</span></span><br><span class="line"><span class="meta">        @Signature(type = Executor.class, method = &quot;query&quot;,</span></span><br><span class="line"><span class="meta">                args = &#123;MappedStatement.class, Object.class, RowBounds.class, ResultHandler.class&#125;)&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SqlInterceptor</span> <span class="keyword">implements</span> <span class="title class_">Interceptor</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Properties properties;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">intercept</span><span class="params">(Invocation invocation)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        <span class="comment">// MappedStatement ç»´æŠ¤äº†ä¸€æ¡ mapper.xml æ–‡ä»¶é‡Œé¢ select ã€updateã€deleteã€insert èŠ‚ç‚¹çš„å°è£…</span></span><br><span class="line">        <span class="type">MappedStatement</span> <span class="variable">mappedStatement</span> <span class="operator">=</span> (MappedStatement) invocation.getArgs()[<span class="number">0</span>];</span><br><span class="line">        <span class="type">Object</span> <span class="variable">parameter</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (invocation.getArgs().length &gt; <span class="number">1</span>) &#123;</span><br><span class="line">            parameter = invocation.getArgs()[<span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">sqlId</span> <span class="operator">=</span> mappedStatement.getId();</span><br><span class="line">        <span class="comment">// è·å–åŠ¨æ€ç”Ÿæˆçš„ SQL è¯­å¥ä»¥åŠç›¸åº”çš„å‚æ•°ä¿¡æ¯å¯¹è±¡</span></span><br><span class="line">        <span class="type">BoundSql</span> <span class="variable">boundSql</span> <span class="operator">=</span> mappedStatement.getBoundSql(parameter);</span><br><span class="line">        <span class="comment">// MyBatis æ‰€æœ‰çš„é…ç½®ä¿¡æ¯éƒ½ç»´æŒåœ¨ Configuration å¯¹è±¡ä¹‹ä¸­ï¼ŒåŒ…æ‹¬ idã€Statement ç±»å‹ã€SQL ç±»å‹ã€mapper çš„ xml æ–‡ä»¶çš„ç»å¯¹åœ°å€ã€æ˜¯å¦ä½¿ç”¨ç¼“å­˜ç­‰é…ç½®</span></span><br><span class="line">        <span class="type">Configuration</span> <span class="variable">configuration</span> <span class="operator">=</span> mappedStatement.getConfiguration();</span><br><span class="line">        <span class="type">Object</span> <span class="variable">returnValue</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">long</span> <span class="variable">start</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="comment">// ç»§ç»­æ‰§è¡ŒåŸç›®æ ‡æ–¹æ³•</span></span><br><span class="line">        returnValue = invocation.proceed();</span><br><span class="line">        <span class="comment">// è·å–å®ä½“ç±»</span></span><br><span class="line">        Class&lt;?&gt; parameterType = getParameterType(mappedStatement);</span><br><span class="line">        <span class="comment">/** åˆ¤æ–­å®ä½“ç±»ä¸Šæ˜¯å¦åŒ…å« <span class="doctag">@SqlPrint</span> æ³¨è§£ï¼Œä¸åŒ…å«çš„è¯ç›´æ¥è¿”å› */</span></span><br><span class="line">        <span class="keyword">if</span> (!hasSqlPrintAnnotation(parameterType)) &#123;</span><br><span class="line">            <span class="keyword">return</span> returnValue;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">long</span> <span class="variable">end</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="type">long</span> <span class="variable">time</span> <span class="operator">=</span> (end - start);</span><br><span class="line">        <span class="comment">/** å½“ SQL æ‰§è¡Œå¤§äº 1 æ¯«ç§’æ—¶æ‰“å° SQLï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥ç”¨äºæ…¢ SQL çš„æ‰“å°åŠç›‘æ§ */</span></span><br><span class="line">        <span class="keyword">if</span> (time &gt; <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> getSql(configuration, boundSql, sqlId, time);</span><br><span class="line">            log.info(sql);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// è¿”å›æ‰§è¡Œåçš„ç»“æœ</span></span><br><span class="line">        <span class="keyword">return</span> returnValue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä½œç”¨ï¼šåŒ…è£…ç›®æ ‡å¯¹è±¡ï¼ŒåŒ…è£…çš„æ„æ€å°±æ˜¯ä¸ºç›®æ ‡å¯¹è±¡åˆ›å»ºä¸€ä¸ªä»£ç†å¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">plugin</span><span class="params">(Object target)</span> &#123;</span><br><span class="line">        <span class="comment">/** åˆ¤æ–­ä¸‹éœ€è¦æ‹¦æˆªçš„ç›®æ ‡å¯¹è±¡ç±»å‹ï¼Œéœ€è¦æ‹¦æˆªæ—¶æ‰æ‹¦æˆªï¼Œå¦åˆ™ç›´æ¥è¿”å›æœ¬èº«ï¼Œå‡å°‘è¢«ä»£ç†çš„æ¬¡æ•° */</span></span><br><span class="line">        <span class="keyword">if</span> (target <span class="keyword">instanceof</span> Executor) &#123;</span><br><span class="line">            <span class="comment">// å€ŸåŠ© Plugin çš„ wrap æ–¹æ³•æ¥ä½¿ç”¨å½“å‰çš„æ‹¦æˆªå™¨åŒ…è£…æˆ‘ä»¬çš„ç›®æ ‡å¯¹è±¡ï¼Œè¿”å›çš„å°±æ˜¯ä¸ºå½“å‰ target åˆ›å»ºçš„åŠ¨æ€ä»£ç†</span></span><br><span class="line">            <span class="comment">// ä½¿ç”¨ JDK çš„åŠ¨æ€ä»£ç†ï¼Œç»™ target å¯¹è±¡åˆ›å»ºä¸€ä¸ª delegate ä»£ç†å¯¹è±¡ï¼Œä»¥æ­¤æ¥å®ç°æ–¹æ³•æ‹¦æˆªå’Œå¢å¼ºåŠŸèƒ½ï¼Œå®ƒä¼šå›è°ƒ intercept() æ–¹æ³•ã€‚</span></span><br><span class="line">            <span class="keyword">return</span> Plugin.wrap(target, <span class="built_in">this</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// æ— éœ€æ‹¦æˆªåˆ™ç›´æ¥è¿”å›ç›®æ ‡å¯¹è±¡æœ¬èº«</span></span><br><span class="line">            <span class="keyword">return</span> target;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å°†æ’ä»¶æ³¨å†Œæ—¶çš„ property å±æ€§è®¾ç½®è¿›æ¥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setProperties</span><span class="params">(Properties properties)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.properties = properties;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç»„è£…éœ€è¦æ‰“å°çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬ SQL è¯­å¥ã€ç‰¹æ®Šæ ‡è®°ã€SQL æ‰§è¡Œæ—¶é—´ç­‰</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> configuration MyBatis æ‰€æœ‰çš„é…ç½®ä¿¡æ¯éƒ½ç»´æŒåœ¨ Configuration å¯¹è±¡ä¹‹ä¸­</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> boundSql è¡¨ç¤ºåŠ¨æ€ç”Ÿæˆçš„ SQL è¯­å¥ä»¥åŠç›¸åº”çš„å‚æ•°ä¿¡æ¯å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sqlId æ‹¦æˆªçš„æ‰§è¡Œ SQL çš„idï¼ˆå¯ä»¥ç†è§£ä¸ºæ–¹æ³•ï¼‰</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> time SQL æ‰§è¡Œæ—¶é—´</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String <span class="title function_">getSql</span><span class="params">(Configuration configuration, BoundSql boundSql, String sqlId, <span class="type">long</span> time)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> showSql(configuration, boundSql);</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">str</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>(<span class="number">100</span>);</span><br><span class="line">        <span class="comment">// æ‹¦æˆªçš„æ‰§è¡Œ SQL çš„idï¼ˆå¯ä»¥ç†è§£ä¸ºæ–¹æ³•ï¼‰ï¼Œä¾‹å¦‚ï¼šcom.gorge4j.user.mapper.UserManageDemoMyBatisMapper.update</span></span><br><span class="line">        str.append(sqlId);</span><br><span class="line">        str.append(<span class="string">&quot; : &quot;</span>);</span><br><span class="line">        <span class="comment">// å…·ä½“æ‰§è¡Œçš„ SQL è¯­å¥</span></span><br><span class="line">        str.append(sql);</span><br><span class="line">        str.append(<span class="string">&quot; &gt;&gt;&gt;&gt;&gt;&gt; &quot;</span>);</span><br><span class="line">        <span class="comment">// SQL æ‰§è¡Œçš„æ—¶é—´</span></span><br><span class="line">        str.append(<span class="string">&quot;SQLæ‰§è¡Œè€—æ—¶: &quot;</span>);</span><br><span class="line">        str.append(time);</span><br><span class="line">        str.append(<span class="string">&quot;ms&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> str.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** æŒ‰ç±»å‹æ ¼å¼åŒ– SQL é‡Œçš„å‚æ•° */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String <span class="title function_">getFormatParameterValue</span><span class="params">(Object obj)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (obj <span class="keyword">instanceof</span> String) &#123;</span><br><span class="line">            value = <span class="string">&quot;&#x27;&quot;</span> + obj.toString() + <span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (obj <span class="keyword">instanceof</span> Date) &#123;</span><br><span class="line">            <span class="type">DateFormat</span> <span class="variable">formatter</span> <span class="operator">=</span> DateFormat.getDateTimeInstance(DateFormat.DEFAULT, DateFormat.DEFAULT, Locale.CHINA);</span><br><span class="line">            value = <span class="string">&quot;&#x27;&quot;</span> + formatter.format(<span class="keyword">new</span> <span class="title class_">Date</span>()) + <span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (obj != <span class="literal">null</span>) &#123;</span><br><span class="line">                value = obj.toString();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                value = <span class="string">&quot;&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** ç»„è£…éœ€è¦æ‰“å°çš„ SQL */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String <span class="title function_">showSql</span><span class="params">(Configuration configuration, BoundSql boundSql)</span> &#123;</span><br><span class="line">        <span class="comment">// å–å¾—å‚æ•°çš„å¯¹è±¡ï¼Œå®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªå¤šä¸ªå‚æ•°çš„ map ç»“æ„</span></span><br><span class="line">        <span class="comment">// ç¤ºä¾‹ï¼šparameterObject:MapperMethod&#123;password=123456,name=xxxxxx,type=O,param3=O,param1=xxxxxx,param2=123456&#125;</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">parameterObject</span> <span class="operator">=</span> boundSql.getParameterObject();</span><br><span class="line">        <span class="comment">// æŸ¥è¯¢ SQL ä¸­çš„å‚æ•°</span></span><br><span class="line">        List&lt;ParameterMapping&gt; parameterMappings = boundSql.getParameterMappings();</span><br><span class="line">        <span class="comment">// å°† SQL ä¸­ä¸€ä¸ªæˆ–å¤šä¸ªå›è½¦æ¢è¡Œç¬¦å·æ›¿æ¢æˆä¸€ä¸ªç©ºæ ¼</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> boundSql.getSql().replaceAll(<span class="string">&quot;[\\s]+&quot;</span>, <span class="string">&quot; &quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (!parameterMappings.isEmpty() &amp;&amp; parameterObject != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="comment">// Mybatis åœ¨å¯åŠ¨æ—¶å°±ä¼šé€šè¿‡ TypeHandlerRegistry è¿›è¡Œæ³¨å†Œï¼Œå³å»ºç«‹ JdbcType, JavaType, TypeHandler ä¸‰è€…ä¹‹é—´çš„å…³ç³»ã€‚</span></span><br><span class="line">            <span class="comment">// å› æ­¤ï¼Œè¿™æ„å‘³ç€åœ¨ Mybatis å¯åŠ¨æ—¶æˆ‘ä»¬ä¹Ÿéœ€è¦é€šè¿‡ TypeHandlerRegistry å°†æˆ‘ä»¬çš„æ‰€æœ‰çš„æšä¸¾ç±»å‹ï¼ˆJavaTypeï¼‰ä¸è‡ªå®šä¹‰çš„æšä¸¾</span></span><br><span class="line">            <span class="comment">// TypeHandlerï¼ˆEnumTypeHandlerï¼‰å»ºç«‹è”ç³»</span></span><br><span class="line">            <span class="type">TypeHandlerRegistry</span> <span class="variable">typeHandlerRegistry</span> <span class="operator">=</span> configuration.getTypeHandlerRegistry();</span><br><span class="line">            <span class="comment">// è‡ªå®šä¹‰ TypeHandler æ—¶ä¼šèµ°è¿™ä¸ªé€»è¾‘ï¼Œå»ºç«‹ JavaType å’Œ JdbcType ä¹‹é—´çš„è”ç³»</span></span><br><span class="line">            <span class="keyword">if</span> (typeHandlerRegistry.hasTypeHandler(parameterObject.getClass())) &#123;</span><br><span class="line">                <span class="comment">// æ›¿æ¢ SQL ä¸­çš„å ä½ç¬¦ â€œ?â€ ä¸ºå…·ä½“çš„å‚æ•°ï¼ŒreplaceFirst ä½œä¸ºæ˜¯æ›¿æ¢åŒ¹é…åˆ°çš„ç¬¬ä¸€ä¸ªå ä½ç¬¦ â€œ?â€</span></span><br><span class="line">                sql = sql.replaceFirst(<span class="string">&quot;\\?&quot;</span>, getFormatParameterValue(parameterObject));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// æ²¡æœ‰è‡ªå®šä¹‰çš„ TypeHandlerï¼Œèµ°é€šç”¨é€»è¾‘</span></span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// æ‹¿åˆ° targetï¼ˆæ‹¦æˆªå¯¹è±¡ï¼‰çš„å…ƒæ•°æ®</span></span><br><span class="line">                <span class="type">MetaObject</span> <span class="variable">metaObject</span> <span class="operator">=</span> configuration.newMetaObject(parameterObject);</span><br><span class="line">                <span class="comment">// å‚æ•°æ˜¯æŒ‰é¡ºåºå­˜å‚¨çš„ï¼Œä¸‹é¢é€»è¾‘æŒ‰é¡ºåºæ¥æ›¿æ¢</span></span><br><span class="line">                <span class="keyword">for</span> (ParameterMapping parameterMapping : parameterMappings) &#123;</span><br><span class="line">                    <span class="comment">// è·å–å‚æ•°çš„åç§°</span></span><br><span class="line">                    <span class="type">String</span> <span class="variable">propertyName</span> <span class="operator">=</span> parameterMapping.getProperty();</span><br><span class="line">                    <span class="comment">// å¦‚æœå…ƒæ•°æ®å¯¹è±¡ä¸­å­˜åœ¨è¯¥å‚æ•°ï¼Œåˆ™æ›¿æ¢ç›¸åº”çš„å ä½ç¬¦ â€œ?â€</span></span><br><span class="line">                    <span class="keyword">if</span> (metaObject.hasGetter(propertyName)) &#123;</span><br><span class="line">                        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> metaObject.getValue(propertyName);</span><br><span class="line">                        sql = sql.replaceFirst(<span class="string">&quot;\\?&quot;</span>, getFormatParameterValue(obj));</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="comment">// å¦‚æœæœ‰é¢å¤–çš„å‚æ•°ï¼Œèµ°ä¸‹é¢çš„é€»è¾‘</span></span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span> (boundSql.hasAdditionalParameter(propertyName)) &#123;</span><br><span class="line">                        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> boundSql.getAdditionalParameter(propertyName);</span><br><span class="line">                        sql = sql.replaceFirst(<span class="string">&quot;\\?&quot;</span>, getFormatParameterValue(obj));</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// è¿”å›ç»„è£…å¥½çš„ SQL</span></span><br><span class="line">        <span class="keyword">return</span> sql;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** è·å–å®ä½“å¯¹è±¡ç±»ï¼šclass com.gorge4j.user.entity.UserManageDemoMyBatis */</span></span><br><span class="line">    <span class="keyword">private</span> Class&lt;?&gt; getParameterType(MappedStatement statement) &#123;</span><br><span class="line">        <span class="keyword">if</span> (statement.getParameterMap() == <span class="literal">null</span> || statement.getParameterMap().getType() == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> statement.getParameterMap().getType();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** åˆ¤æ–­å®ä½“ç±»ä¸Šæ˜¯å¦åŒ…å«è‡ªå®šä¹‰çš„ SQl æ‰“å°çš„æ³¨è§£ <span class="doctag">@SqlPrint</span> */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">hasSqlPrintAnnotation</span><span class="params">(Class&lt;?&gt; classType)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> classType == <span class="literal">null</span> ? Boolean.FALSE : classType.isAnnotationPresent(SqlPrint.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<blockquote>
<p>æ³¨æ„ï¼šéœ€è¦åœ¨å®ä½“ç±»ä¸Šæ·»åŠ è‡ªå®šä¹‰æ³¨è§£ @SqlPrint</p>
</blockquote>
<p>è‡ªå®šä¹‰æ³¨è§£ç±»ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Retention(RUNTIME)</span></span><br><span class="line"><span class="meta">@Target(TYPE)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> SqlPrint &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è‡ªå®šä¹‰çš„ SQL æ—¥å¿—æ‰“å°æ ·å¼ï¼š</p>
<p><img src="/img/2020/03/UserManagementSystem/SQLLog03.png" alt="" /></p>
<h3 id="è·¨åŸŸ"><a class="markdownIt-Anchor" href="#è·¨åŸŸ"></a> è·¨åŸŸ</h3>
<blockquote>
<p>è·¨åŸŸï¼Œæ˜¯æŒ‡æµè§ˆå™¨ä¸èƒ½æ‰§è¡Œå…¶ä»–ç½‘ç«™çš„è„šæœ¬ã€‚å®ƒæ˜¯ç”±æµè§ˆå™¨çš„åŒæºç­–ç•¥é€ æˆçš„ï¼Œæ˜¯æµè§ˆå™¨å¯¹ JavaScript å®æ–½çš„å®‰å…¨ç­–ç•¥ã€‚</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CorsConfig</span> <span class="keyword">extends</span> <span class="title class_">WebMvcConfigurationSupport</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addCorsMappings</span><span class="params">(CorsRegistry registry)</span> &#123;</span><br><span class="line">		registry.addMapping(<span class="string">&quot;/**&quot;</span>)</span><br><span class="line">            .allowedOrigins(<span class="string">&quot;*&quot;</span>)</span><br><span class="line">            .allowCredentials(<span class="literal">true</span>)</span><br><span class="line">            .allowedHeaders(<span class="string">&quot;*&quot;</span>)</span><br><span class="line">            .allowedMethods(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;POST&quot;</span>, <span class="string">&quot;DELETE&quot;</span>, <span class="string">&quot;PUT&quot;</span>, <span class="string">&quot;OPTIONS&quot;</span>)</span><br><span class="line">            .maxAge(<span class="number">3600</span>);</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="comment">// é…ç½® Swagger çš„èµ„æºæ˜ å°„</span></span><br><span class="line">     <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addResourceHandlers</span><span class="params">(ResourceHandlerRegistry registry)</span> &#123;</span><br><span class="line"></span><br><span class="line">        registry.addResourceHandler(<span class="string">&quot;swagger-ui.html&quot;</span>)</span><br><span class="line">                .addResourceLocations(<span class="string">&quot;classpath:/META-INF/resources/&quot;</span>);</span><br><span class="line"></span><br><span class="line">        registry.addResourceHandler(<span class="string">&quot;/webjars/**&quot;</span>)</span><br><span class="line">                .addResourceLocations(<span class="string">&quot;classpath:/META-INF/resources/webjars/&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="æ³¨æ„"><a class="markdownIt-Anchor" href="#æ³¨æ„"></a> æ³¨æ„</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@see</span> EnableWebMvc ç”¨äº†æ­¤æ³¨è§£é»˜è®¤é…ç½®çš„ MVC å¤±æ•ˆï¼Œéœ€è¦ç”¨æˆ·é‡æ–°é…ç½®</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@see</span> WebMvcConfigurer</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebMvcConfigurationSupport</span> ...</span><br></pre></td></tr></table></figure>
<h3 id="è‡ªå®šä¹‰æ ¡éªŒ"><a class="markdownIt-Anchor" href="#è‡ªå®šä¹‰æ ¡éªŒ"></a> è‡ªå®šä¹‰æ ¡éªŒ</h3>
<blockquote>
<p>é™¤äº†ä½¿ç”¨é»˜è®¤æä¾›çš„ Validatorï¼Œç”¨æˆ·è¿˜å¯ä»¥æä¾›å…·æœ‰è‡ªå®šä¹‰æ ¡éªŒè§„åˆ™çš„ Validatorã€‚</p>
</blockquote>
<h4 id="æ³¨è§£ç±»"><a class="markdownIt-Anchor" href="#æ³¨è§£ç±»"></a> æ³¨è§£ç±»</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target(&#123;ElementType.FIELD&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Constraint(validatedBy = UsernameValidator.class)</span> <span class="comment">// å¼•å…¥æ ¡éªŒè§„åˆ™ç±»è¿›è¡Œæ ¡éªŒ</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Username &#123;</span><br><span class="line">    <span class="comment">// é”™è¯¯æç¤ºæ¶ˆæ¯ @Username(message = &quot;&quot;)</span></span><br><span class="line">    String <span class="title function_">message</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&#123;com.wingo.user.annotaion.Username.message&#125;&quot;</span>;</span><br><span class="line">    Class&lt;?&gt;[] groups() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line">    Class&lt;? <span class="keyword">extends</span> <span class="title class_">Payload</span>&gt;[] payload() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target(&#123;ElementType.FIELD&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Constraint(validatedBy = PasswordValidator.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Password &#123;</span><br><span class="line">    String <span class="title function_">message</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&#123;com.wingo.user.annotaion.Password.message&#125;&quot;</span>;</span><br><span class="line">    Class&lt;?&gt;[] groups() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line">    Class&lt;? <span class="keyword">extends</span> <span class="title class_">Payload</span>&gt;[] payload() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="æ ¡éªŒç±»"><a class="markdownIt-Anchor" href="#æ ¡éªŒç±»"></a> æ ¡éªŒç±»</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UsernameValidator</span> <span class="keyword">implements</span> <span class="title class_">ConstraintValidator</span>&lt;Username, String&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initialize</span><span class="params">(Username constraintAnnotation)</span> &#123;</span><br><span class="line">        <span class="comment">// do nothing</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isValid</span><span class="params">(String value, ConstraintValidatorContext context)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isBlank(value)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> Pattern.matches(RegexConstant.REGEX_USERNAME, value);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PasswordValidator</span> <span class="keyword">implements</span> <span class="title class_">ConstraintValidator</span>&lt;Password, String&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initialize</span><span class="params">(Password constraintAnnotation)</span> &#123;</span><br><span class="line">        <span class="comment">// do nothing</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isValid</span><span class="params">(String value, ConstraintValidatorContext context)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isBlank(value)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ­£åˆ™åŒ¹é…</span></span><br><span class="line">        <span class="keyword">return</span> Pattern.matches(RegexConstant.REGEX_PASS, value);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="è¯·æ±‚å“åº”æ‰“å°"><a class="markdownIt-Anchor" href="#è¯·æ±‚å“åº”æ‰“å°"></a> è¯·æ±‚å“åº”æ‰“å°</h3>
<blockquote>
<p>åˆ‡é¢ï¼šæ–¹æ³•å‰æ‰“å°è¯·æ±‚ä¿¡æ¯å‚æ•°ï¼›æ–¹æ³•åæ‰“å°å“åº”ä¿¡æ¯ã€‚</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReqAndRespLogAspect</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¯·æ±‚å‚æ•°çš„æ—¥å¿—æ‰“å°</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> joinPoint åˆ‡ç‚¹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Before(&quot;within(com.wingo.user.controller.*)&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">before</span><span class="params">(JoinPoint joinPoint)</span> &#123;</span><br><span class="line">        <span class="comment">// è·å–ä¼ å…¥ç›®æ ‡æ–¹æ³•çš„å‚æ•°å¯¹è±¡</span></span><br><span class="line">        Object[] args = joinPoint.getArgs();</span><br><span class="line">        <span class="comment">// è·å–å°è£…äº†ç½²åä¿¡æ¯çš„å¯¹è±¡,åœ¨è¯¥å¯¹è±¡ä¸­å¯ä»¥è·å–åˆ°ç›®æ ‡æ–¹æ³•å,æ‰€å±ç±»çš„Classç­‰ä¿¡æ¯</span></span><br><span class="line">        <span class="type">MethodSignature</span> <span class="variable">methodSignature</span> <span class="operator">=</span> (MethodSignature) joinPoint.getSignature();</span><br><span class="line">        <span class="comment">// è·å–æ–¹æ³•å¯¹è±¡</span></span><br><span class="line">        <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> methodSignature.getMethod();</span><br><span class="line">        <span class="comment">// åˆ†å‰²ç»„è£…å‚æ•°</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">strArgs</span> <span class="operator">=</span> StringUtils.join(args, <span class="string">&quot;,&quot;</span>);</span><br><span class="line">        log.info(<span class="string">&quot;&#123;&#125;.&#123;&#125; - è¯·æ±‚å‚æ•°: &#123;&#125;&quot;</span>, method.getDeclaringClass().getName(), method.getName(), strArgs);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å“åº”ç»“æœçš„æ—¥å¿—æ‰“å°</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> joinPoint åˆ‡ç‚¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> res å“åº”ç»“æœå¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@AfterReturning(value = &quot;within(com.wingo.user.controller.*)&quot;, returning = &quot;res&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">after</span><span class="params">(JoinPoint joinPoint, Object res)</span> &#123;</span><br><span class="line">        <span class="comment">// è·å–å°è£…äº†ç½²åä¿¡æ¯çš„å¯¹è±¡,åœ¨è¯¥å¯¹è±¡ä¸­å¯ä»¥è·å–åˆ°ç›®æ ‡æ–¹æ³•å,æ‰€å±ç±»çš„ Class ç­‰ä¿¡æ¯</span></span><br><span class="line">        <span class="type">MethodSignature</span> <span class="variable">methodSignature</span> <span class="operator">=</span> (MethodSignature) joinPoint.getSignature();</span><br><span class="line">        <span class="comment">// è·å–æ–¹æ³•å¯¹è±¡</span></span><br><span class="line">        <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> methodSignature.getMethod();</span><br><span class="line">        <span class="comment">// å°†è¿”å›å¯¹è±¡è½¬æ¢æˆ Json å­—ç¬¦ä¸²ï¼Œé¡¹ç›®çš„è¿”å›å¦‚æœä¸æ˜¯ Json çš„æ•°æ®æ ¼å¼ï¼Œé‚£ä¹ˆè¿”å›å‚æ•°å°±åªæœ‰ URL</span></span><br><span class="line">        <span class="comment">// String strRes = JSONUtils.toJSONString(res);</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">strRes</span> <span class="operator">=</span> res.toString();</span><br><span class="line">        log.info(<span class="string">&quot;&#123;&#125;.&#123;&#125; - è¿”å›ç»“æœ: &#123;&#125;&quot;</span>, method.getDeclaringClass().getName(), method.getName(), strRes);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <!-- <div class="article-footer">
      <blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    
    <li class="post-copyright-link hidden-xs">
      <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong>
      <a href="https://wingowen.github.io/2020/03/07/%E5%90%8E%E5%8F%B0%E6%8A%80%E6%9C%AF/%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91/%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/" title="ç”¨æˆ·ç®¡ç†ç³»ç»Ÿ" target="_blank" rel="external">https://wingowen.github.io/2020/03/07/åå°æŠ€æœ¯/é¡¹ç›®å¼€å‘/ç”¨æˆ·ç®¡ç†ç³»ç»Ÿ/</a>
    </li>
    
    <li class="post-copyright-license">
      <strong>ç‰ˆæƒå£°æ˜ï¼š </strong> æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CNåè®®</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
    </li>
  </ul>
</blockquote>


<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="/images/avatar.jpg" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="" target="_blank"><span class="text-dark">WINGO.WEN</span><small class="ml-1x"></small></a></h3>
        <div>ä¸€ä¸ªç–¯å­ã€‚</div>
      </div>
    </figure>
  </div>
</div>


    </div> -->
  </article>
  
    
  <section id="comments">
  	
  </section>


  
</div>

  <nav class="bar bar-footer clearfix" data-stick-bottom>
  <div class="bar-inner">
  
  <ul class="pager pull-left">
    
    <li class="prev">
      <a href="/2020/03/12/%E5%90%8E%E5%8F%B0%E6%8A%80%E6%9C%AF/%E5%BC%80%E5%8F%91%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7%E7%B1%BB/" title="å¼€å‘å¸¸ç”¨å·¥å…·ç±»"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;ä¸Šä¸€ç¯‡</span></a>
    </li>
    
    
    <li class="next">
      <a href="/2020/03/05/%E5%90%8E%E5%8F%B0%E6%8A%80%E6%9C%AF/Spring%20Boot/Spring%20Boot%20%E6%95%B0%E6%8D%AE%E8%AE%BF%E9%97%AE/" title="Spring Boot æ•°æ®è®¿é—®"><span>ä¸‹ä¸€ç¯‡&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a>
    </li>
    
    
    <li class="toggle-toc">
      <a class="toggle-btn " data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="æ–‡ç« ç›®å½•" role="button">    <span>[&nbsp;</span><span>æ–‡ç« ç›®å½•</span>
        <i class="text-collapsed icon icon-anchor"></i>
        <i class="text-in icon icon-close"></i>
        <span>]</span>
      </a>
    </li>
    
  </ul>
  
  
  
  <div class="bar-right">
    
  </div>
  </div>
</nav>
  


</main>

  <footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
	
    <div class="copyright">
    	
        <div class="publishby">
        	<!-- Theme by <a href="https://github.com/cofess" target="_blank"> cofess </a>base on <a href="https://github.com/cofess/hexo-theme-pure" target="_blank">pure</a>. -->
        </div>
    </div>
</footer>
  <script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script>
window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>

<script src="/js/plugin.min.js"></script>


<script src="/js/application.js"></script>


    <script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'æ–‡ç« ',
            PAGES: 'é¡µé¢',
            CATEGORIES: 'åˆ†ç±»',
            TAGS: 'æ ‡ç­¾',
            UNTITLED: '(æœªå‘½å)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>






   




   






</body>
</html>